
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../scraping_prom_tgi/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>ESTADISTICAS - GEAM IT</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="23abf7" data-md-color-accent="light-blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href=".." title="GEAM IT" class="md-header__button md-logo" aria-label="GEAM IT" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            GEAM IT
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ESTADISTICAS
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="GEAM IT" class="md-nav__button md-logo" aria-label="GEAM IT" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    GEAM IT
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    INTRODUCCIÓN
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    ESTADISTICAS
  </span>
  

      </a>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../scraping_prom_tgi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PROMIGAS TGI
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../precio_bolsa/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PRECIO BOLSA HORARIO
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../despachp_nal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DESPACHO NACIONAL
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../calculadora/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CALCULADORA
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../cambios_xm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CAMBIOS XM
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../sharepoint/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SHAREPOINT
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>ESTADISTICAS</h1>

<!-- markdownlint-disable -->
<h3 id="automatizacion-de-analisis-energetico-con-pydataxm"><strong>Automatización de Análisis Energético con PyDataXM</strong></h3>
<hr />
<h3 id="1-introduccion"><strong>1. Introducción</strong></h3>
<p>El presente sistema automatiza la consulta, procesamiento y análisis de datos energéticos utilizando la API de <strong>XM</strong> a través de la librería <strong>PyDataXM</strong>. Esta herramienta permite obtener información clave sobre el mercado eléctrico colombiano, incluyendo el consumo de combustible, generación de energía, precios de bolsa, embalses y demanda del Sistema Interconectado Nacional (SIN).  </p>
<p>Este proceso es fundamental para garantizar la eficiencia operativa y la toma de decisiones basada en datos en tiempo real dentro del sector eléctrico. La automatización facilita el acceso a información confiable, agiliza el análisis de datos históricos y permite detectar tendencias críticas para la planificación energética.</p>
<hr />
<h3 id="2-objetivo-del-sistema"><strong>2. Objetivo del Sistema</strong></h3>
<p>El sistema tiene como propósito principal:</p>
<ol>
<li><strong>Automatizar la consulta de datos</strong> energéticos desde la API de XM mediante la librería PyDataXM.</li>
<li><strong>Realizar un análisis detallado</strong> del consumo de combustible y la generación eléctrica.</li>
<li><strong>Monitorear indicadores clave</strong>, como los precios de la bolsa, los niveles de embalses y la demanda eléctrica.</li>
<li><strong>Exportar los resultados a un archivo Excel</strong> con múltiples hojas para facilitar el análisis y la visualización de tendencias.</li>
</ol>
<hr />
<h3 id="3-descripcion-general-del-sistema"><strong>3. Descripción General del Sistema</strong></h3>
<p>El sistema está compuesto por seis módulos principales:</p>
<ol>
<li><strong><code>logger()</code></strong>: Configuración del sistema de registro de eventos y errores.</li>
<li><strong><code>decoratortimeprocess(func)</code></strong>: Decorador para medir el tiempo de ejecución de las funciones.</li>
<li><strong>Funciones de consulta de datos</strong> desde la API de XM:</li>
<li><strong><code>consumo_combustible()</code></strong>: Consulta y analiza el consumo de combustible (MBTU) por recurso.</li>
<li><strong><code>generacion()</code></strong>: Obtiene los datos de generación eléctrica por recurso.</li>
<li><strong><code>indicadores()</code></strong>: Extrae información sobre los precios de bolsa.</li>
<li><strong><code>embalses()</code></strong>: Analiza los niveles de embalses y aportes hídricos.</li>
<li><strong><code>DemaSIN()</code></strong>: Obtiene los valores de demanda del sistema interconectado nacional (SIN).</li>
<li><strong><code>main()</code></strong>: Ejecuta el flujo completo, genera el archivo Excel con los datos y almacena los resultados.</li>
</ol>
<hr />
<h3 id="4-configuracion-inicial"><strong>4. Configuración Inicial</strong></h3>
<h4 id="41-requisitos-del-sistema"><strong>4.1 Requisitos del Sistema</strong></h4>
<p>Para utilizar este sistema, es necesario contar con:</p>
<ul>
<li><strong>Python 3.8 o superior</strong>.</li>
<li>Librerías requeridas:
  <div class="highlight"><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>pydataxm<span class="w"> </span>pandas<span class="w"> </span>openpyxl
</code></pre></div></li>
<li><strong>Acceso a la API de XM</strong> con permisos para consultar datos históricos.</li>
</ul>
<h4 id="42-estructura-del-proyecto"><strong>4.2 Estructura del Proyecto</strong></h4>
<p>La estructura del sistema es la siguiente:</p>
<div class="highlight"><pre><span></span><code>/analisis_energetico.py
/logs/
  ├── Ejecucion.log
/resultados/
  ├── Estadisticas.xlsx
</code></pre></div>
<hr />
<h3 id="5-descripcion-detallada-de-los-modulos"><strong>5. Descripción Detallada de los Módulos</strong></h3>
<h4 id="51-logger"><strong>5.1 <code>logger()</code></strong></h4>
<p>Configura un sistema de registro que almacena eventos en un archivo <code>Ejecucion.log</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">logger</span><span class="p">():</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> - </span><span class="si">%(name)s</span><span class="s1"> - </span><span class="si">%(levelname)s</span><span class="s1"> - </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
    <span class="n">log_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;Ejecucion.log&#39;</span><span class="p">)</span>
    <span class="n">handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="n">log_path</span><span class="p">)</span>
    <span class="n">handler</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
    <span class="n">formatter</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> - </span><span class="si">%(name)s</span><span class="s1"> - </span><span class="si">%(levelname)s</span><span class="s1"> - </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">logger</span>
</code></pre></div>
<hr />
<h4 id="52-decoratortimeprocessfunc"><strong>5.2 <code>decoratortimeprocess(func)</code></strong></h4>
<p>Mide el tiempo de ejecución de cada función y lo registra en el log.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">decoratortimeprocess</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">end</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="n">logger</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Tiempo de ejecución de la función </span><span class="si">{</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="k">return</span> <span class="n">wrapper</span>
</code></pre></div>
<hr />
<h4 id="53-consumo_combustible"><strong>5.3 <code>consumo_combustible()</code></strong></h4>
<p>Obtiene el consumo de combustible (MBTU) por recurso y lo filtra para incluir solo la planta TESORITO.</p>
<div class="highlight"><pre><span></span><code><span class="nd">@decoratortimeprocess</span>
<span class="k">def</span><span class="w"> </span><span class="nf">consumo_combustible</span><span class="p">():</span>
    <span class="n">df_consulta</span> <span class="o">=</span> <span class="n">api_XM</span><span class="o">.</span><span class="n">request_data</span><span class="p">(</span>
        <span class="s1">&#39;ConsCombustibleMBTU&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Recurso&#39;</span><span class="p">,</span>
        <span class="n">dt</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="o">*</span><span class="n">periodo_inicial</span><span class="p">),</span>
        <span class="n">dt</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="o">*</span><span class="n">periodo_final</span><span class="p">))</span>

    <span class="n">df_consumo_combustible</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_consulta</span><span class="p">,</span> <span class="n">df_sistema</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Values_code&#39;</span><span class="p">],</span> <span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Values_Code&#39;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
    <span class="n">df_consumo_combustible</span><span class="p">[</span><span class="s1">&#39;Consumo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_consumo_combustible</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">like</span><span class="o">=</span><span class="s1">&#39;Values_Hour&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">df_consumo_combustible</span> <span class="o">=</span> <span class="n">df_consumo_combustible</span><span class="p">[</span><span class="n">df_consumo_combustible</span><span class="p">[</span><span class="s1">&#39;Values_Name_y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;TESORITO&quot;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>
    <span class="n">df_consumo_combustible</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Id_x&#39;</span><span class="p">,</span> <span class="s1">&#39;Values_code&#39;</span><span class="p">,</span> <span class="s1">&#39;Id_y&#39;</span><span class="p">,</span> <span class="s1">&#39;Values_Code&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df_consumo_combustible</span>
</code></pre></div>
<hr />
<h4 id="54-generacion"><strong>5.4 <code>generacion()</code></strong></h4>
<p>Consulta la generación de energía por recurso y la filtra por la planta TESORITO.</p>
<div class="highlight"><pre><span></span><code><span class="nd">@decoratortimeprocess</span>
<span class="k">def</span><span class="w"> </span><span class="nf">generacion</span><span class="p">():</span>
    <span class="n">df_consulta</span> <span class="o">=</span> <span class="n">api_XM</span><span class="o">.</span><span class="n">request_data</span><span class="p">(</span>
        <span class="s1">&#39;Gene&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Recurso&#39;</span><span class="p">,</span>
        <span class="n">dt</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="o">*</span><span class="n">periodo_inicial</span><span class="p">),</span>
        <span class="n">dt</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="o">*</span><span class="n">periodo_final</span><span class="p">))</span>

    <span class="n">df_generacion</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_consulta</span><span class="p">,</span> <span class="n">df_sistema</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Values_code&#39;</span><span class="p">],</span> <span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Values_Code&#39;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
    <span class="n">df_generacion</span><span class="p">[</span><span class="s1">&#39;Generación&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_generacion</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">like</span><span class="o">=</span><span class="s1">&#39;Values_Hour&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">df_generacion</span> <span class="o">=</span> <span class="n">df_generacion</span><span class="p">[</span><span class="n">df_generacion</span><span class="p">[</span><span class="s1">&#39;Values_Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;TESORITO&quot;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>
    <span class="n">df_generacion</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Id_x&#39;</span><span class="p">,</span> <span class="s1">&#39;Values_code&#39;</span><span class="p">,</span> <span class="s1">&#39;Id_y&#39;</span><span class="p">,</span> <span class="s1">&#39;Values_Code&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df_generacion</span>
</code></pre></div>
<hr />
<h4 id="55-indicadores"><strong>5.5 <code>indicadores()</code></strong></h4>
<p>Obtiene los precios de la bolsa nacional y su promedio ponderado.</p>
<div class="highlight"><pre><span></span><code><span class="nd">@decoratortimeprocess</span>
<span class="k">def</span><span class="w"> </span><span class="nf">indicadores</span><span class="p">():</span>
    <span class="n">df_PrecBolsNaci</span> <span class="o">=</span> <span class="n">api_XM</span><span class="o">.</span><span class="n">request_data</span><span class="p">(</span><span class="s1">&#39;PrecBolsNaci&#39;</span><span class="p">,</span> <span class="s1">&#39;Sistema&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="o">*</span><span class="n">periodo_inicial</span><span class="p">),</span> <span class="n">dt</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="o">*</span><span class="n">periodo_final</span><span class="p">))</span>
    <span class="n">df_PPPrecBolsNaci</span> <span class="o">=</span> <span class="n">api_XM</span><span class="o">.</span><span class="n">request_data</span><span class="p">(</span><span class="s1">&#39;PPPrecBolsNaci&#39;</span><span class="p">,</span> <span class="s1">&#39;Sistema&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="o">*</span><span class="n">periodo_inicial</span><span class="p">),</span> <span class="n">dt</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="o">*</span><span class="n">periodo_final</span><span class="p">))</span>

    <span class="n">df_PrecBolsNaci</span><span class="p">[</span><span class="s1">&#39;PrecBolsNaci&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_PrecBolsNaci</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">like</span><span class="o">=</span><span class="s1">&#39;Values_Hour&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">df_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_PrecBolsNaci</span><span class="p">,</span> <span class="n">df_PPPrecBolsNaci</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
    <span class="n">df_final</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Value&#39;</span><span class="p">:</span> <span class="s1">&#39;PPPrecBolsNaci&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df_final</span><span class="p">[[</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="s1">&#39;PrecBolsNaci&#39;</span><span class="p">,</span> <span class="s1">&#39;PPPrecBolsNaci&#39;</span><span class="p">]]</span>
</code></pre></div>
<hr />
<h4 id="56-main"><strong>5.6 <code>main()</code></strong></h4>
<p>Ejecuta el flujo completo y guarda los resultados en un archivo Excel.</p>
<div class="highlight"><pre><span></span><code><span class="nd">@decoratortimeprocess</span>
<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="n">usuario</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getlogin</span><span class="p">()</span>
    <span class="n">file_estadisticas</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">Users</span><span class="se">\\</span><span class="si">{</span><span class="n">usuario</span><span class="si">}</span><span class="se">\\</span><span class="s2">OneDrive - GEAM</span><span class="se">\\</span><span class="s2">Operaciones GEAM</span><span class="se">\\</span><span class="s2">Gestion</span><span class="se">\\</span><span class="s2">Despacho Nal&quot;</span><span class="p">,</span> <span class="s2">&quot;Estadisticas.xlsx&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file_estadisticas</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">file_estadisticas</span><span class="p">)</span>

    <span class="n">df_consumo</span> <span class="o">=</span> <span class="n">consumo_combustible</span><span class="p">()</span>
    <span class="n">df_generacion</span> <span class="o">=</span> <span class="n">generacion</span><span class="p">()</span>
    <span class="n">df_indicadores</span> <span class="o">=</span> <span class="n">indicadores</span><span class="p">()</span>

    <span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="n">file_estadisticas</span><span class="p">)</span> <span class="k">as</span> <span class="n">writer</span><span class="p">:</span>
        <span class="n">df_consumo</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Consumo_combustible&#39;</span><span class="p">)</span>
        <span class="n">df_generacion</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Generacion&#39;</span><span class="p">)</span>
        <span class="n">df_indicadores</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Indicadores&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div>
<hr />
<h3 id="6-conclusion"><strong>6. Conclusión</strong></h3>
<p>Este sistema proporciona una automatización eficiente para el análisis de datos energéticos en el mercado eléctrico colombiano. Al integrar la API de XM con herramientas de procesamiento de datos en Python, se logra una recopilación rápida y precisa de información crítica para la toma de decisiones estratégicas.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}}</script>
    
    
      <script src="../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
        <script src="../js/mkdocs_pagetree_plugin.js"></script>
      
        <script src="../js/init_mermaid.js"></script>
      
    
  </body>
</html>