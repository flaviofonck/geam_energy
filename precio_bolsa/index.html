
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../scraping_prom_tgi/">
      
      
        <link rel="next" href="../despachp_nal/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>PRECIO BOLSA HORARIO - GEAM IT</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="23abf7" data-md-color-accent="light-blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href=".." title="GEAM IT" class="md-header__button md-logo" aria-label="GEAM IT" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            GEAM IT
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              PRECIO BOLSA HORARIO
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="GEAM IT" class="md-nav__button md-logo" aria-label="GEAM IT" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    GEAM IT
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    INTRODUCCIÓN
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../estadisticas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ESTADISTICAS
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../scraping_prom_tgi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PROMIGAS TGI
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    PRECIO BOLSA HORARIO
  </span>
  

      </a>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../despachp_nal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DESPACHO NACIONAL
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../calculadora/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CALCULADORA
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../cambios_xm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CAMBIOS XM
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../sharepoint/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SHAREPOINT
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<!-- markdownlint-disable -->
<h1 id="_1"></h1>
<div style="display: flex; align-items: center;">
<div align="center"><H2>PRECIO BOLSA HORARIO</H2></div> 
  <img src="../images/Logo Geam.png" alt="Logo" style="margin-left: auto;">
</div>

<h3 id="automatizacion-del-predespacho-ideal-con-analisis-del-costo-marginal">Automatización del Predespacho Ideal con Análisis del Costo Marginal</h3>
<p><img alt="alt text" src="../images/preciografica.jpg" /></p>
<h3 id="1-introduccion"><strong>1. Introducción</strong></h3>
<p>El sistema desarrollado automatiza la descarga, procesamiento y análisis de los datos del <strong>Predespacho Ideal</strong> proporcionados por <strong>XM</strong>. Este análisis es fundamental para evaluar el comportamiento del mercado eléctrico, ya que los costos marginales y precios de oferta influyen directamente en la planificación y operación compañia. Mediante esta automatización, se garantiza una supervisión continua del mercado, lo que permite detectar tendencias, prevenir posibles riesgos y optimizar la toma de decisiones basada en datos actualizados y precisos. Esto es especialmente útil para operadores del mercado, generadores y entidades reguladoras que requieren información en tiempo real para la gestión eficiente de la demanda y oferta de energía.</p>
<h4 id="que-es-el-predespacho-ideal"><strong>¿Qué es el Predespacho Ideal?</strong></h4>
<p>El <strong>Predespacho Ideal</strong> contiene información sobre:</p>
<ul>
<li>El programa de generación para cada recurso disponible durante el día especificado (<strong>dd</strong>).</li>
<li>Los precios de oferta del recurso denominado <strong>MPO</strong> en cada periodo del día.</li>
</ul>
<h4 id="objetivo-principal">Objetivo Principal</h4>
<p>La finalidad de este script es obtener información esencial sobre el programa de generación y los precios de oferta de recursos del <strong>Predespacho Ideal</strong>. Además, se realiza un análisis detallado de los datos del costo marginal para identificar tendencias, valores clave y umbrales de escasez. Este análisis ayuda a tomar decisiones informadas en tiempo real dentro del contexto de la operación del sistema eléctrico.</p>
<h4 id="funcionalidades-principales">Funcionalidades Principales</h4>
<ol>
<li>
<p><strong>Descarga y Validación de Archivos:</strong></p>
<ul>
<li>
<p>El script busca automáticamente los archivos esperados, nombrados según el formato de fecha del día siguiente (<code>public_imar_nalMMDD.txt</code> y <code>iMARMMDD_NAL.txt</code>).</p>
</li>
<li>
<p>En caso de no encontrar los archivos en el sistema local, el script intenta obtenerlos mediante scraping desde al portal de <strong>XM</strong>. Para ésto se utiliza Selenium para navegar automáticamente al sitio web y descargar los archivos necesarios.</p>
</li>
</ul>
</li>
<li>
<p><strong>Procesamiento de Datos:</strong></p>
<ul>
<li>Los archivos descargados son leídos para extraer los datos correspondientes al costo marginal, que se presentan en un formato delimitado por comas.</li>
</ul>
</li>
</ol>
<div class="highlight"><pre><span></span><code>      <span class="n">Costo</span> <span class="n">Marginal</span><span class="s2">&quot;,710110,640110,630110,630110,640110,710110,710110,710110,640110,630110,640110,710110,710110,710110,710110,710110,730003,730110,850110,910110,850110,750110,730003,710110</span>
<span class="s2">&quot;Delta&quot;</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span><span class="mi">110</span>
<span class="s2">&quot;MPO&quot;</span><span class="p">,</span><span class="mi">710000</span><span class="p">,</span><span class="mi">640000</span><span class="p">,</span><span class="mi">630000</span><span class="p">,</span><span class="mi">630000</span><span class="p">,</span><span class="mi">640000</span><span class="p">,</span><span class="mi">710000</span><span class="p">,</span><span class="mi">710000</span><span class="p">,</span><span class="mi">710000</span><span class="p">,</span><span class="mi">640000</span><span class="p">,</span><span class="mi">630000</span><span class="p">,</span><span class="mi">640000</span><span class="p">,</span><span class="mi">710000</span><span class="p">,</span><span class="mi">710000</span><span class="p">,</span><span class="mi">710000</span><span class="p">,</span><span class="mi">710000</span><span class="p">,</span><span class="mi">710000</span><span class="p">,</span><span class="mi">729893</span><span class="p">,</span><span class="mi">730000</span><span class="p">,</span><span class="mi">850000</span><span class="p">,</span><span class="mi">910000</span><span class="p">,</span><span class="mi">850000</span><span class="p">,</span><span class="mi">750000</span><span class="p">,</span><span class="mi">729893</span><span class="p">,</span><span class="mi">710000</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>  - Los datos extraídos son convertidos a una lista de valores numéricos para su análisis y visualización.
</code></pre></div>

<ol>
<li>
<p><strong>Análisis del Costo Marginal:</strong></p>
<ul>
<li>Se realizan cálculos de máximos, mínimos y promedios del costo marginal.</li>
<li>Se define un <strong>umbral de escasez</strong>, equivalente al 95% de un valor de referencia fijo (mes) (970.59), para identificar periodos críticos.</li>
<li>Los valores que superan este umbral son clasificados y sus rangos son identificados.</li>
</ul>
</li>
<li>
<p><strong>Visualización Gráfica:</strong></p>
<ul>
<li>El costo marginal es graficado con indicadores claros de los valores máximos, mínimos y aquellos cercanos al umbral de escasez.</li>
<li>Cambios significativos en la serie son resaltados visualmente.</li>
<li>La gráfica se guarda como un archivo de imagen para documentación y referencia.</li>
</ul>
</li>
<li>
<p><strong>Narrativa y Documentación:</strong></p>
<ul>
<li>Se genera un archivo de texto que incluye una narrativa descriptiva del análisis realizado, destacando los valores más relevantes y los periodos críticos.</li>
<li>Este archivo facilita la comunicación de los resultados a las partes interesadas.</li>
</ul>
</li>
<li>
<p><strong>Gestión de Errores y Reintentos:</strong></p>
<ul>
<li>El sistema implementa un mecanismo de espera y reintento automático en caso de que los archivos no estén disponibles inicialmente.</li>
<li>Este enfoque asegura la resiliencia y fiabilidad del proceso.</li>
</ul>
</li>
<li>
<p><strong>Notificación por Correo Electrónico:</strong></p>
<ul>
<li>El sistema envía un correo electrónico al equipo de operaciones con los resultados del análisis en tiempo real.</li>
<li>El correo incluye la gráfica del costo marginal y el reporte narrativo generado.</li>
<li>
<p>Configuración del correo:
  <div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">smtplib</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">email</span><span class="w"> </span><span class="kn">import</span> <span class="n">encoders</span>

<span class="k">def</span><span class="w"> </span><span class="nf">enviar_correo</span><span class="p">(</span><span class="n">destinatario</span><span class="p">,</span> <span class="n">asunto</span><span class="p">,</span> <span class="n">cuerpo</span><span class="p">,</span> <span class="n">archivo_adjunto</span><span class="p">):</span>
          <span class="n">remitente</span> <span class="o">=</span> <span class="s2">&quot;tu_correo@example.com&quot;</span>
          <span class="n">password</span> <span class="o">=</span> <span class="s2">&quot;tu_contraseña&quot;</span>
</code></pre></div></p>
</li>
<li>
<p>Ejemplo:</p>
</li>
</ul>
</li>
</ol>
<p><img alt="alt text" src="../images/correo_precio.jpg" width="50%" /></p>
<hr />
<h4 id="importancia-operativa">Importancia Operativa</h4>
<p>Este sistema es esencial para la operación eficiente y confiable del mercado eléctrico, ya que proporciona:</p>
<ul>
<li><strong>Información en Tiempo Real:</strong> Los datos procesados permiten ajustar decisiones operativas según las condiciones del mercado.</li>
</ul>
<h3 id="2-descripcion-general-del-sistema"><strong>2. Descripción General del Sistema</strong></h3>
<p>El sistema está compuesto por dos módulos principales:</p>
<ol>
<li><strong><code>marginal.py</code></strong> (Principal): Responsable de procesar los datos descargados, analizar los costos marginales y generar gráficos y reportes detallados.</li>
<li><strong><code>predespacho_ideal.py</code></strong>: Módulo auxiliar encargado de realizar la descarga automática de los datos desde el portal de XM mediante Selenium.</li>
</ol>
<hr />
<h3 id="3-configuracion-inicial"><strong>3. Configuración Inicial</strong></h3>
<h4 id="31-requisitos-del-sistema"><strong>3.1 Requisitos del Sistema</strong></h4>
<p>Para utilizar este sistema, es necesario contar con:</p>
<ul>
<li><strong>Python 3.8 o superior.</strong></li>
<li>Librerías requeridas:
     <div class="highlight"><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>selenium<span class="w"> </span>matplotlib<span class="w"> </span>pandas<span class="w"> </span>webdriver-manager
</code></pre></div></li>
<li><strong>Google Chrome</strong> instalado y actualizado.</li>
</ul>
<h4 id="32-configuracion-de-selenium"><strong>3.2 Configuración de Selenium</strong></h4>
<p>El sistema utiliza Selenium en modo <strong>headless</strong> para realizar las descargas:</p>
<ul>
<li><strong>Carpeta de destino:</strong><br />
     <div class="highlight"><pre><span></span><code>C:\Users\&lt;usuario&gt;\OneDrive - GEAM\Operaciones GEAM\Operaciones\Despacho\
</code></pre></div></li>
<li><strong>Configuración adicional del navegador:</strong><br />
     El navegador está configurado para descargar automáticamente los archivos sin intervención del usuario.</li>
</ul>
<h4 id="33-estructura-del-proyecto"><strong>3.3 Estructura del Proyecto</strong></h4>
<p>El sistema debe organizarse como sigue:
    <div class="highlight"><pre><span></span><code>/marginal.py
/predespacho_ideal.py
</code></pre></div>
    Archivos generados:</p>
<ul>
<li><strong>Gráficos y reportes:</strong> Se almacenan en la carpeta designada.</li>
</ul>
<h3 id="4-descripcion-detallada-de-los-modulos"><strong>4. Descripción Detallada de los Módulos</strong></h3>
<h4 id="41-marginalpy"><strong>4.1 <code>marginal.py</code></strong></h4>
<p>Este es el módulo principal que ejecuta el flujo completo del sistema. Sus principales tareas incluyen:</p>
<ol>
<li>Llamar a <code>predespacho_ideal.py</code> para descargar los datos.</li>
<li>Analizar la información del costo marginal.</li>
<li>Generar gráficos y reportes narrativos.</li>
</ol>
<p><strong>Funciones Clave:</strong></p>
<h5 id="funcion-graficar_costo_marginalcosto_marginal_nuevo"><em><strong>Función</strong></em> <strong><code>graficar_costo_marginal(costo_marginal_nuevo)</code></strong></h5>
<p>Analiza y visualiza los costos marginales.  </p>
<ul>
<li><strong>Cálculos realizados:</strong><ul>
<li>Máximos, mínimos y promedios del costo marginal.</li>
<li>Identificación de valores que exceden el <strong>umbral de escasez</strong> (95% de 951.76).</li>
</ul>
</li>
<li><strong>Salida:</strong><ul>
<li>Una gráfica que resalta valores significativos.</li>
<li>Una narrativa descriptiva con resultados clave.</li>
</ul>
</li>
</ul>
<p><strong>Fragmento Relevante:</strong>
<div class="highlight"><pre><span></span><code><span class="n">umbral_escasez</span> <span class="o">=</span> <span class="n">escasez</span> <span class="o">*</span> <span class="mf">0.95</span>
<span class="n">valores_sobre_umbral</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">valor</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">costo_marginal_dividido</span><span class="p">)</span> <span class="k">if</span> <span class="n">valor</span> <span class="o">&gt;</span> <span class="n">umbral_escasez</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">umbral_escasez</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Umbral de Escasez: $</span><span class="si">{</span><span class="n">umbral_escasez</span><span class="si">:</span><span class="s1">,.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</code></pre></div></p>
<h5 id="funcion-esperartiempo-intento"><em><strong>Función</strong></em> <strong><code>esperar(tiempo, intento)</code></strong></h5>
<p>Gestiona los temporizadores en caso de que los archivos no estén disponibles.  </p>
<p><strong>Fragmento Relevante:</strong>
<div class="highlight"><pre><span></span><code><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">tiempo</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>        
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Esperando </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">s... Intento </span><span class="si">{</span><span class="n">intento</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></p>
<h5 id="interaccion-con-predespacho_idealpy"><strong>Interacción con <code>predespacho_ideal.py</code></strong></h5>
<p>El módulo llama a la función <code>ejecutar()</code> para descargar los archivos necesarios.</p>
<h4 id="42-predespacho_idealpy"><strong>4.2 <code>predespacho_ideal.py</code></strong></h4>
<p>Este módulo utiliza Selenium para interactuar con el portal de XM y descargar los datos del <strong>Predespacho Ideal</strong>.</p>
<p><strong>Funciones Clave:</strong></p>
<h5 id="funcion-ejecutar"><em><strong>Función</strong></em> <strong><code>ejecutar()</code></strong></h5>
<p>Descarga los archivos requeridos desde el portal de XM:</p>
<ul>
<li>Navega al sitio correspondiente.</li>
<li>Identifica dinámicamente el archivo deseado.</li>
<li>Realiza la descarga y lo guarda en la carpeta designada.</li>
</ul>
<p><strong>Fragmento Relevante:</strong>
<div class="highlight"><pre><span></span><code><span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;https://www.xm.com.co/corto-plazo/despacho-energia/predespacho-ideal&quot;</span><span class="p">)</span>
<span class="n">button_element</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
</code></pre></div></p>
<h5 id="funcion-continuar_procesodriver"><em><strong>Función</strong></em> <strong><code>continuar_proceso(driver)</code></strong></h5>
<p>Procesa el contenido de la página web y convierte el texto CSV en datos tabulares utilizables.</p>
<h3 id="5-flujo-de-operacion"><strong>5. Flujo de Operación</strong></h3>
<ol>
<li>
<p><strong>Ejecutar <code>marginal.py</code>:</strong>
   <div class="highlight"><pre><span></span><code>python<span class="w"> </span>marginal.py
</code></pre></div></p>
</li>
<li>
<p><strong>Descarga de Archivos:</strong></p>
<ul>
<li>El sistema navega automáticamente al portal de XM.</li>
<li>Identifica y descarga los archivos relacionados con el día siguiente.</li>
</ul>
</li>
<li>
<p><strong>Análisis de los Datos:</strong></p>
<ul>
<li>Se procesan los costos marginales.</li>
<li>Se genera una gráfica y un reporte narrativo.</li>
</ul>
</li>
<li>
<p><strong>Resultados Generados:</strong></p>
<ul>
<li><strong>Gráfica del Costo Marginal:</strong><br />
    <div class="highlight"><pre><span></span><code>C:\Users\&lt;usuario&gt;\OneDrive - GEAM\Operaciones GEAM\Operaciones\Despacho\pbolsahorario_image.png
</code></pre></div></li>
<li><strong>Reporte Narrativo:</strong><br />
    <div class="highlight"><pre><span></span><code>C:\Users\&lt;usuario&gt;\OneDrive - GEAM\Operaciones GEAM\Operaciones\Despacho\pbolsahorario_texto.txt
</code></pre></div></li>
</ul>
</li>
</ol>
<h4 id="diagrama-de-flujo-de-procesos">Diagrama de flujo de procesos</h4>
<pre class="mermaid"><code>graph TD
    A[Inicia Ejecución del Script] --&gt; B[Verifica Archivos Locales]
    B --&gt;|Archivos Disponibles| C[Procesa Datos]
    B --&gt;|Archivos No Disponibles| D[Descarga Archivos del Portal XM]
    D --&gt; E[Valida Archivos Descargados]
    E --&gt;|Validación Exitosa| C
    E --&gt;|Error en la Validación| F[Reintenta Descarga]
    F --&gt; D
    C --&gt; G[Realiza Cálculos del Costo Marginal]
    G --&gt; J[Genera Gráfica de Resultados]
    G --&gt; K[Genera Narrativa de Resultados]
    J --&gt; L[Finaliza Proceso]
    K --&gt; L</code></pre>
<p>Este diagrama representa el flujo del sistema para la automatización del <strong>Predespacho Ideal</strong>, desde la ejecución del script hasta la generación de gráficos y reportes narrativos. Cada paso incluye validaciones y reintentos automáticos en caso de errores.</p>
<h3 id="6-solucion-de-problemas"><strong>6. Solución de Problemas</strong></h3>
<ul>
<li>
<p><strong>El sistema no descarga los archivos:</strong></p>
<ul>
<li>Verifica que el sitio web de XM esté accesible.</li>
<li>Revisa los permisos de la carpeta de destino.</li>
</ul>
</li>
<li>
<p><strong>Errores con Selenium:</strong></p>
<ul>
<li>Asegúrate de tener instalada la última versión de ChromeDriver:
  <div class="highlight"><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>webdriver-manager
</code></pre></div></li>
</ul>
</li>
<li>
<p><strong>Los datos están incompletos o no se procesan correctamente:</strong></p>
<ul>
<li>Confirma que los archivos descargados contengan la información esperada.</li>
</ul>
</li>
</ul>
<h4 id="conclusion">Conclusión</h4>
<p>Este sistema de scraping y análisis del <strong>Predespacho Ideal</strong> es una herramienta poderosa para los operadores del mercado eléctrico. No solo automatiza procesos críticos, sino que también ofrece un análisis profundo y visual de los datos más relevantes, asegurando decisiones informadas en un entorno altamente regulado. Este enfoque resalta la importancia de la digitalización y automatización en la gestión moderna de sistemas eléctricos.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}}</script>
    
    
      <script src="../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
        <script src="../js/mkdocs_pagetree_plugin.js"></script>
      
        <script src="../js/init_mermaid.js"></script>
      
    
  </body>
</html>