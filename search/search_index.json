{"config":{"lang":["es"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"INTRODUCCI\u00d3N","text":""},{"location":"#proyecto-integrado-automatizacion-de-gestion-energetica","title":"Proyecto Integrado: Automatizaci\u00f3n de Gesti\u00f3n Energ\u00e9tica","text":""},{"location":"#proposito-del-proyecto","title":"Prop\u00f3sito del Proyecto","text":"<p>Sistema integral para la gesti\u00f3n automatizada de datos estrat\u00e9gicos en los mercados el\u00e9ctrico y de gas natural en Colombia, compuesto por cuatro m\u00f3dulos clave:</p> M\u00f3dulo Funci\u00f3n 1. Despacho Nacional Monitorea programas diarios de generaci\u00f3n el\u00e9ctrica 2. Predespacho Ideal Analiza costos marginales y precios de oferta 3. TGI Registra vol\u00famenes diarios de gas transportado 4. Promigas Mide entregas de gas por productor (KPCD) <ol> <li> <p>Despacho Nacional:    Automatizaci\u00f3n del monitoreo, descarga y an\u00e1lisis de datos relacionados con el programa de generaci\u00f3n y los recursos asociados al Despacho Nacional. Este proceso garantiza la eficiencia operativa y la precisi\u00f3n de los datos</p> </li> <li> <p>Predespacho Ideal:    Gesti\u00f3n automatizada para obtener y analizar informaci\u00f3n relacionada con los costos marginales y los precios de oferta en el mercado el\u00e9ctrico. Este sistema asegura un an\u00e1lisis detallado para la toma de decisiones informadas.</p> </li> <li> <p>Datos TGI y Promogas:    Este sistema automatiza la descarga y procesamiento de datos de vol\u00famenes de gas de TGI y Promigas, actores clave en la distribuci\u00f3n de gas natural en Colombia. Proporciona informaci\u00f3n cr\u00edtica para la gesti\u00f3n operativa diaria</p> </li> </ol>"},{"location":"#arquitectura-del-sistema","title":"Arquitectura del Sistema","text":"<pre><code>graph TD\n    A[Portal XM] --&gt; B[Despacho Nacional]\n    A --&gt; C[Predespacho Ideal]\n    D[Portal TGI] --&gt; E[Consolidado Recibos]\n    F[Portal Promigas] --&gt; G[Vol\u00famenes Entregados]\n    B &amp; C --&gt; H[Procesamiento El\u00e9ctrico]\n    E &amp; G --&gt; I[Procesamiento Gas Natural]\n    H &amp; I --&gt; J[Base de Datos Central]\n    J --&gt; K[Reportes Automatizados]</code></pre>"},{"location":"#flujo-operativo-integrado","title":"Flujo Operativo Integrado","text":"<ol> <li> <p>Programaci\u00f3n Centralizada    Tareas Windows configuradas para ejecuci\u00f3n diaria:</p> <ul> <li>08:00: Monitoreo gas (TGI + Promigas) Cada 30 minutos hasta las 11:00 a.m. para garantizar la optenci\u00f3n de toda la informaci\u00f3n.      </li> <li>09:00: Monitoreo el\u00e9ctrico Predespacho hasta tanto salga el reporte</li> <li>09:30: Monitoreo Despacho Nacional y Ties</li> </ul> </li> <li> <p>Alertas Unificadas    Sistema de notificaciones combinado:</p> </li> <li>Correo: Env\u00edo de alertas cr\u00edticas</li> <li>Archivo log \u00fanico: <code>registro_operaciones.log</code></li> </ol>"},{"location":"#caracteristicas-clave","title":"Caracter\u00edsticas Clave","text":"<ol> <li> <p>Automatizaci\u00f3n Completa:    Los sistemas automatizan la descarga de datos desde el portal oficial de XM, procesan los datos en tiempo real y generan reportes detallados. Esto elimina la necesidad de supervisi\u00f3n manual constante y mejora la precisi\u00f3n operativa.</p> </li> <li> <p>Interactividad y Configuraci\u00f3n Personalizable:    Ambos sistemas cuentan con interfaces gr\u00e1ficas intuitivas desarrolladas en Tkinter, que permiten:</p> <ul> <li>Monitorear en tiempo real.</li> <li>Configurar par\u00e1metros como tiempos de espera y alertas espec\u00edficas.</li> <li>Cambiar entre modos de operaci\u00f3n seg\u00fan las necesidades operativas.</li> </ul> </li> <li> <p>Resiliencia Operativa:    Los mecanismos de reintento y manejo de errores aseguran que los sistemas contin\u00faen funcionando incluso en situaciones de falla temporal, como la indisponibilidad de archivos en el portal de XM.</p> </li> <li> <p>Ejecuci\u00f3n Autom\u00e1tica:     Por medio del gestor de tareas de Windows, se programa que los scripts se ejecuten autom\u00e1ticamente e inicien el monitoreo en el horario establecido.</p> </li> </ol>"},{"location":"#manejo-de-datos","title":"Manejo de Datos","text":""},{"location":"#estructura-de-almacenamiento","title":"Estructura de Almacenamiento","text":"<pre><code>/GEAM_Operaciones/\n\u251c\u2500\u2500 El\u00e9ctrico/\n\u2502   \u251c\u2500\u2500 Despacho_Nacional Preliminar/\n\u2502   \u251c\u2500\u2500 Despacho_Nacional Ties/\n\u2502   \u2514\u2500\u2500 Predespacho_Ideal/\n\u2514\u2500\u2500 Gas/\n    \u251c\u2500\u2500 TGI/\n    \u2514\u2500\u2500 Promigas/\n</code></pre>"},{"location":"#transformaciones-clave","title":"Transformaciones Clave","text":"M\u00f3dulo Operaci\u00f3n Tecnolog\u00eda Despacho Nacional Normalizaci\u00f3n perfiles de generaci\u00f3n Pandas + NumPy Predespacho Ideal C\u00e1lculo promedios m\u00f3viles 24h Window Functions TGI Conversi\u00f3n m\u00b3 \u2192 BTU Pandas + NumPy Promigas Agregaci\u00f3n diaria KPCD Pandas + Numpy"},{"location":"#sistema-de-logs","title":"Sistema de Logs","text":"<pre><code>2024-03-15 07:02:15 | INFO | Despacho Nacional | Archivo descargado: public_ddec_nal20240315.txt\n2024-03-15 08:35:00 | WARN | TGI | Reintento 2/3 - Error de conexi\u00f3n\n2024-03-15 08:35:30 | SUCCESS | TGI | Archivo procesado: volumen_tgi.xlsx\n</code></pre>"},{"location":"#beneficios-operativos","title":"Beneficios Operativos","text":"\u00c1rea Impacto Eficiencia Reducci\u00f3n de 85% en tiempo de procesamiento Confiabilidad 99.7% de disponibilidad hist\u00f3rica de datos Toma de Decisiones Dashboards integrados electricidad-gas"},{"location":"#hoja-de-ruta","title":"Hoja de Ruta","text":"<ol> <li> <p>Fase 2 (2025-Q3): </p> <ul> <li>Interfaz gr\u00e1fica completa.</li> <li>Inclusi\u00f3n de herramientas como la Calculadora de Tarifas</li> </ul> </li> <li> <p>Fase 3 (2025-Q4): </p> <ul> <li>Versi\u00f3n m\u00f3vil con notificaciones push</li> <li>M\u00f3dulo de reporting </li> </ul> </li> <li> <p>Fase 4 (2026-Q1)</p> <ul> <li>Iterfaz Web</li> </ul> </li> </ol>"},{"location":"about/","title":"Acerca de este proyecto","text":"<p>Este proyecto tiene como objetivo proporcionar una soluci\u00f3n eficiente y f\u00e1cil de usar para [describir el prop\u00f3sito del proyecto]. </p>"},{"location":"about/#proposito","title":"Prop\u00f3sito","text":"<p>El prop\u00f3sito de este proyecto es [especificar el prop\u00f3sito del proyecto, por ejemplo, facilitar la edici\u00f3n de documentos, mejorar la colaboraci\u00f3n, etc.].</p>"},{"location":"about/#caracteristicas","title":"Caracter\u00edsticas","text":"<ul> <li>Caracter\u00edstica 1: [Descripci\u00f3n de la caracter\u00edstica 1]</li> <li>Caracter\u00edstica 2: [Descripci\u00f3n de la caracter\u00edstica 2]</li> <li>Caracter\u00edstica 3: [Descripci\u00f3n de la caracter\u00edstica 3]</li> </ul>"},{"location":"about/#detalles-relevantes","title":"Detalles relevantes","text":"<p>Para m\u00e1s informaci\u00f3n sobre c\u00f3mo contribuir o utilizar este proyecto, consulte la documentaci\u00f3n en [enlace a la documentaci\u00f3n o repositorio].</p>"},{"location":"buenaspracticas/","title":"BUENAS PR\u00c1CTICAS","text":""},{"location":"buenaspracticas/#buenas-practicas-implementadas-en-el-proyecto","title":"Buenas Pr\u00e1cticas Implementadas en el Proyecto","text":"<p>El sistema de monitoreo y procesamiento del Despacho Nacional implementa una serie de buenas pr\u00e1cticas que aseguran la eficiencia, escalabilidad, calidad y mantenibilidad de los procesos, aline\u00e1ndose con los requerimientos normativos y operativos. A continuaci\u00f3n, se detallan estas pr\u00e1cticas:</p>"},{"location":"buenaspracticas/#1-arquitectura-modular-y-escalable","title":"1. Arquitectura Modular y Escalable","text":"<p>Descripci\u00f3n: El sistema est\u00e1 dise\u00f1ado de forma modular, separando las responsabilidades de la interfaz gr\u00e1fica y la automatizaci\u00f3n del monitoreo.</p> <p>Ejemplo: </p> <ul> <li>Componentes clave:<ul> <li><code>DespachoApp</code>: Maneja la interfaz gr\u00e1fica y la interacci\u00f3n con el usuario.</li> <li>Automatizaci\u00f3n con Selenium: Realiza la descarga y validaci\u00f3n de datos.</li> </ul> </li> </ul> <p>Beneficios: </p> <ul> <li>Facilita la integraci\u00f3n de nuevas funcionalidades.</li> <li>Asegura la escalabilidad del sistema para manejar vol\u00famenes crecientes de datos.</li> </ul>"},{"location":"buenaspracticas/#2-uso-de-selenium-para-automatizacion","title":"2. Uso de Selenium para Automatizaci\u00f3n","text":"<p>Descripci\u00f3n: Selenium se utiliza para acceder al portal de XM, interactuar con elementos en Shadow DOM y descargar los archivos requeridos.</p> <p>Ejemplo: </p> <ul> <li>Automatizaci\u00f3n de clics en men\u00fas desplegables y descargas de archivos.</li> <li>Manejo din\u00e1mico de elementos web mediante scripts personalizados.</li> </ul> <p>Beneficios: </p> <ul> <li>Elimina tareas manuales repetitivas.</li> <li>Asegura precisi\u00f3n en la interacci\u00f3n con la plataforma de XM.</li> </ul>"},{"location":"buenaspracticas/#3-gestion-eficiente-de-descargas","title":"3. Gesti\u00f3n Eficiente de Descargas","text":"<p>Descripci\u00f3n: El sistema implementa un control de versiones y gesti\u00f3n de archivos descargados.</p> <p>Ejemplo: </p> <ul> <li>Verificaci\u00f3n de la existencia de archivos antes de descargarlos.</li> <li>Generaci\u00f3n de nombres \u00fanicos para evitar sobrescrituras.</li> </ul> <p>Beneficios: </p> <ul> <li>Previene la p\u00e9rdida de datos.</li> <li>Asegura la trazabilidad de los archivos descargados.</li> </ul>"},{"location":"buenaspracticas/#4-interfaz-grafica-amigable","title":"4. Interfaz Gr\u00e1fica Amigable","text":"<p>Descripci\u00f3n: La interfaz gr\u00e1fica basada en <code>Tkinter</code> permite a los usuarios configurar y monitorear los procesos de forma intuitiva.</p> <p>Ejemplo: </p> <ul> <li>Personalizaci\u00f3n del tiempo de espera y alertas mediante opciones gr\u00e1ficas.</li> <li>Visualizaci\u00f3n en tiempo real de los logs y estado del sistema.</li> </ul> <p>Beneficios: </p> <ul> <li>Mejora la experiencia del usuario.</li> <li>Facilita la operaci\u00f3n del sistema sin necesidad de conocimientos t\u00e9cnicos avanzados.</li> </ul>"},{"location":"buenaspracticas/#5-seguridad-en-la-gestion-de-credenciales","title":"5. Seguridad en la Gesti\u00f3n de Credenciales","text":"<p>Descripci\u00f3n: Las credenciales utilizadas para configuraciones y accesos se gestionan de forma segura mediante variables externas.</p> <p>Ejemplo: </p> <ul> <li>Almacenamiento de credenciales en un archivo <code>.env</code>.</li> <li>Funciones espec\u00edficas para leer y usar estas credenciales sin exponerlas en el c\u00f3digo.</li> </ul> <p>Beneficios: </p> <ul> <li>Minimiza riesgos de exposici\u00f3n de informaci\u00f3n sensible.</li> <li>Simplifica la gesti\u00f3n de credenciales en diferentes entornos.</li> </ul>"},{"location":"buenaspracticas/#6-mecanismos-de-resiliencia-y-manejo-de-errores","title":"6. Mecanismos de Resiliencia y Manejo de Errores","text":"<p>Descripci\u00f3n: El sistema incluye un manejo robusto de errores y un esquema de reintentos autom\u00e1ticos.</p> <p>Ejemplo: </p> <ul> <li>Reintentos en caso de que el portal de XM no est\u00e9 accesible.</li> <li>Logs detallados de errores para facilitar la depuraci\u00f3n.</li> </ul> <p>Beneficios: </p> <ul> <li>Incrementa la confiabilidad del sistema.</li> <li>Asegura la continuidad de los procesos en escenarios adversos.</li> </ul>"},{"location":"buenaspracticas/#7-registro-detallado-con-logging","title":"7. Registro Detallado con <code>logging</code>","text":"<p>Descripci\u00f3n: El uso del m\u00f3dulo <code>logging</code> permite registrar eventos clave, errores y tiempos de ejecuci\u00f3n.</p> <p>Ejemplo: </p> <ul> <li>Decoradores personalizados para medir y registrar el tiempo de cada proceso.</li> <li>Registro de eventos en consola y archivo de logs.</li> </ul> <p>Beneficios: </p> <ul> <li>Facilita la depuraci\u00f3n y monitoreo del sistema.</li> <li>Proporciona trazabilidad completa de las operaciones realizadas.</li> </ul>"},{"location":"buenaspracticas/#8-configuracion-personalizable","title":"8. Configuraci\u00f3n Personalizable","text":"<p>Descripci\u00f3n: El sistema permite ajustar par\u00e1metros de operaci\u00f3n directamente desde la l\u00ednea de comandos.</p> <p>Ejemplo: </p> <ul> <li>Configuraci\u00f3n del tiempo de espera (<code>--Time</code>).</li> <li>Activaci\u00f3n del modo headless (<code>--key</code>).</li> </ul> <p>Beneficios: </p> <ul> <li>Flexibilidad para adaptarse a diferentes escenarios.</li> <li>Permite una configuraci\u00f3n r\u00e1pida y sin necesidad de modificar el c\u00f3digo.</li> </ul>"},{"location":"buenaspracticas/#9-analisis-y-procesamiento-de-datos-con-pandas","title":"9. An\u00e1lisis y Procesamiento de Datos con <code>pandas</code>","text":"<p>Descripci\u00f3n: El uso de <code>pandas</code> facilita el manejo eficiente de los datos descargados.</p> <p>Ejemplo: </p> <ul> <li>Conversi\u00f3n de archivos descargados en DataFrames para su an\u00e1lisis.</li> <li>Procesamiento de datos para generar reportes consistentes.</li> </ul> <p>Beneficios: </p> <ul> <li>Mejora la eficiencia en el manejo de datos.</li> <li>Simplifica la generaci\u00f3n de informaci\u00f3n anal\u00edtica.</li> </ul>"},{"location":"buenaspracticas/#10-automatizacion-del-monitoreo","title":"10. Automatizaci\u00f3n del Monitoreo","text":"<p>Descripci\u00f3n: El sistema monitorea constantemente el portal de XM para identificar cambios en los despachos.</p> <p>Ejemplo: </p> <ul> <li>Identificaci\u00f3n y descarga de nuevos archivos en tiempo real.</li> <li>Actualizaci\u00f3n de la interfaz gr\u00e1fica con el estado del monitoreo.</li> </ul> <p>Beneficios: </p> <ul> <li>Asegura que los datos est\u00e9n siempre actualizados.</li> <li>Reduce la necesidad de supervisi\u00f3n manual constante.</li> </ul>"},{"location":"buenaspracticas/#11-control-de-versiones-en-descargas","title":"11. Control de Versiones en Descargas","text":"<p>Descripci\u00f3n: Se gestionan versiones \u00fanicas de los archivos descargados para evitar redundancias.</p> <p>Ejemplo: </p> <ul> <li>Funciones para renombrar archivos autom\u00e1ticamente al detectarse duplicados.</li> </ul> <p>Beneficios: </p> <ul> <li>Evita conflictos en los datos descargados.</li> <li>Asegura una estructura clara para el almacenamiento.</li> </ul>"},{"location":"buenaspracticas/#12-mantenimiento-simplificado","title":"12. Mantenimiento Simplificado","text":"<p>Descripci\u00f3n: El sistema est\u00e1 dise\u00f1ado para facilitar su mantenimiento y actualizaci\u00f3n.</p> <p>Ejemplo: </p> <ul> <li>C\u00f3digo modular con funciones reutilizables.</li> <li>Separaci\u00f3n clara entre l\u00f3gica de interfaz gr\u00e1fica y automatizaci\u00f3n.</li> </ul> <p>Beneficios: </p> <ul> <li>Reduce tiempos de implementaci\u00f3n de nuevas funcionalidades.</li> <li>Facilita el trabajo de los desarrolladores en el mantenimiento del sistema.</li> </ul>"},{"location":"buenaspracticas/#conclusion","title":"Conclusi\u00f3n","text":"<p>Las buenas pr\u00e1cticas implementadas en el sistema de Despacho Nacional garantizan no solo su efectividad operativa, sino tambi\u00e9n su seguridad, mantenibilidad y escalabilidad. Este enfoque asegura que el sistema se mantenga alineado con los est\u00e1ndares normativos y pueda evolucionar conforme a las necesidades del mercad</p>"},{"location":"despachp_nal/","title":"DESPACHO NACIONAL","text":""},{"location":"despachp_nal/#manual-del-usuario-monitoreo-y-procesamiento-del-despacho-nacional","title":"Manual del Usuario Monitoreo y Procesamiento del Despacho Nacional","text":""},{"location":"despachp_nal/#1-introduccion","title":"1. Introducci\u00f3n","text":"<p>El sistema desarrollado tiene como objetivo principal la automatizaci\u00f3n del monitoreo, descarga, y procesamiento de los datos correspondientes al Despacho Nacional, proporcionados por XM. Este proceso asegura un an\u00e1lisis eficiente y detallado de los programas de generaci\u00f3n y recursos disponibles, cumpliendo con las regulaciones de la Resoluci\u00f3n CREG 004 de 2003, CREG 014 de 2004, CREG 096 de 2008, CREG 051 de 2009, y CREG 076 de 2009.</p>"},{"location":"despachp_nal/#que-es-el-despacho-nacional","title":"\u00bfQu\u00e9 es el Despacho Nacional?","text":"<p>El Despacho Nacional contiene informaci\u00f3n referente a:</p> <ul> <li>El programa de generaci\u00f3n para cada recurso en el despacho nacional del d\u00eda (dd) del mes (mm).</li> <li>Datos cr\u00edticos necesarios para la gesti\u00f3n y optimizaci\u00f3n de recursos energ\u00e9ticos en el corto plazo.</li> </ul> <p>En caso de no encontrar los archivos requeridos, se recomienda consultar el servicio FTPS disponible en la ruta: <code>/INFORMACION_XM/Publico/DespachoNacional/</code>.</p>"},{"location":"despachp_nal/#objetivo-principal","title":"Objetivo Principal","text":"<p>El objetivo de este sistema es garantizar la disponibilidad de la informaci\u00f3n del programa de generaci\u00f3n y los recursos asociados al Despacho Nacional del d\u00eda espec\u00edfico. Adem\u00e1s, se enfoca en ofrecer herramientas interactivas para monitorear cambios en los despachos, analizar los datos y emitir alertas en tiempo real seg\u00fan las necesidades operativas.</p>"},{"location":"despachp_nal/#2-configuracion-inicial","title":"2. Configuraci\u00f3n Inicial","text":""},{"location":"despachp_nal/#21-requisitos-del-sistema","title":"2.1 Requisitos del Sistema","text":"<ul> <li>Python 3.8 o superior.</li> <li>Librer\u00edas necesarias:     <pre><code>pip install selenium pandas webdriver-manager keyboard\n</code></pre></li> <li>Google Chrome instalado y actualizado.</li> </ul>"},{"location":"despachp_nal/#22-configuracion-de-selenium","title":"2.2 Configuraci\u00f3n de Selenium","text":"<p>El sistema utiliza Selenium para interactuar con el portal de XM:</p> <ul> <li>Modo headless (opcional): El navegador puede ejecutarse de forma oculta.</li> <li>Configuraci\u00f3n de descargas autom\u00e1ticas: Los archivos se guardan en la carpeta designada:   <pre><code>C:\\Users\\&lt;usuario&gt;\\OneDrive - GEAM\\Operaciones GEAM\\Gestion\\despacho\\\n</code></pre></li> </ul>"},{"location":"despachp_nal/#23-argumentos-de-linea-de-comandos","title":"2.3 Argumentos de L\u00ednea de Comandos","text":"<p>El script permite personalizar su ejecuci\u00f3n mediante argumentos:</p> <ul> <li><code>--key</code> (bool): Mostrar el navegador durante la ejecuci\u00f3n (por defecto: <code>False</code>).</li> <li><code>--Time</code> (int): Tiempo de espera entre intentos (por defecto: <code>30</code> segundos).</li> <li><code>--Ties</code> (bool): Consultar exclusivamente datos TIES.</li> <li><code>--Nal</code> (bool): Consultar exclusivamente datos NAL.</li> </ul> <p>Ejemplo de ejecuci\u00f3n con argumentos: <pre><code>python despacho_nacional.py --key True --Time 60 --Nal True\n</code></pre></p>"},{"location":"despachp_nal/#funcionalidades-principales","title":"Funcionalidades Principales","text":"<ol> <li> <p>Interfaz Gr\u00e1fica de Usuario (GUI):</p> <ul> <li>Tkinter es utilizado para crear una interfaz amigable que permite al usuario configurar, iniciar y detener el monitoreo del despacho.</li> <li>La interfaz incluye opciones para ajustar par\u00e1metros como el tiempo de espera, seleccionar fuentes y tama\u00f1os de texto, y activar o desactivar alertas espec\u00edficas para los datos TIES y NAL.</li> </ul> </li> <li> <p>Automatizaci\u00f3n del Monitoreo con Selenium:</p> <ul> <li>Se emplea Selenium para acceder al portal web oficial de XM y navegar por su contenido, incluyendo el manejo de elementos incrustados en Shadow DOM.</li> <li>El sistema busca los archivos de despacho actualizados en tiempo real y ejecuta acciones autom\u00e1ticas para descargarlos cuando est\u00e1n disponibles.</li> </ul> </li> <li> <p>Descarga y Procesamiento de Datos:</p> <ul> <li>Los archivos descargados son procesados directamente como DataFrames de pandas, permitiendo una manipulaci\u00f3n eficiente de los datos.</li> <li>Los resultados se guardan tanto en una carpeta espec\u00edfica para operaciones como en el directorio de descargas del usuario, garantizando redundancia y accesibilidad.</li> </ul> </li> <li> <p>Alertas Configurables:</p> <ul> <li>El sistema puede emitir alertas espec\u00edficas cuando se detectan archivos TIES o NAL, seg\u00fan las preferencias del usuario.</li> <li>Las alertas visuales y audibles aseguran que los operadores sean informados inmediatamente de los cambios relevantes.</li> </ul> </li> <li> <p>Resiliencia y Manejo de Errores:</p> <ul> <li>Se implementa un mecanismo de reintento que permite al sistema seguir monitoreando en intervalos configurables si los archivos no est\u00e1n disponibles inicialmente.</li> <li>El monitoreo se puede detener en cualquier momento mediante un bot\u00f3n en la interfaz o pulsando la tecla ESC.</li> </ul> </li> <li> <p>Argumentos de L\u00ednea de Comandos:</p> <ul> <li>El sistema incluye soporte para configurar par\u00e1metros directamente desde la l\u00ednea de comandos, como el tiempo de espera por defecto, la activaci\u00f3n del modo headless, y la selecci\u00f3n de alertas espec\u00edficas.</li> </ul> </li> <li> <p>Medici\u00f3n y Registro del Desempe\u00f1o:</p> <ul> <li>A trav\u00e9s de un decorador personalizado, el sistema mide el tiempo de ejecuci\u00f3n de los procesos clave y registra estos datos para an\u00e1lisis y optimizaci\u00f3n.</li> </ul> </li> </ol>"},{"location":"despachp_nal/#importancia-operativa","title":"Importancia Operativa","text":"<p>Este sistema juega un rol fundamental en la operaci\u00f3n del mercado el\u00e9ctrico al ofrecer:</p> <ul> <li>Monitoreo Automatizado y en Tiempo Real: La soluci\u00f3n elimina la necesidad de supervisi\u00f3n manual constante, optimizando el uso de recursos.</li> <li>Interactividad y Flexibilidad: La interfaz gr\u00e1fica proporciona un control intuitivo sobre los procesos, permitiendo ajustes din\u00e1micos seg\u00fan las necesidades operativas.</li> <li>An\u00e1lisis y Almacenamiento de Datos: Al procesar los datos descargados, se genera informaci\u00f3n valiosa para el an\u00e1lisis hist\u00f3rico y la planificaci\u00f3n.</li> </ul>"},{"location":"despachp_nal/#3-estructura-del-sistema","title":"3. Estructura del Sistema","text":"<p>El sistema consta de dos componentes principales:</p> <ol> <li>Interfaz gr\u00e1fica (<code>tkinter</code>): Permite al usuario monitorear y controlar el proceso en tiempo real.</li> <li>Automatizaci\u00f3n con Selenium: Gestiona la interacci\u00f3n con el portal de XM para descargar los datos.</li> </ol>"},{"location":"despachp_nal/#4-descripcion-detallada-del-sistema","title":"4. Descripci\u00f3n Detallada del Sistema","text":""},{"location":"despachp_nal/#41-interfaz-grafica","title":"4.1 Interfaz Gr\u00e1fica","text":"<p>La interfaz gr\u00e1fica est\u00e1 dise\u00f1ada con <code>tkinter</code> para brindar control y visualizaci\u00f3n en tiempo real.</p> <p>Caracter\u00edsticas Clave:</p> <ul> <li>Logs en Tiempo Real: Visualizaci\u00f3n de eventos y mensajes del sistema.</li> <li>Opciones de Configuraci\u00f3n:<ul> <li>Activar o desactivar consultas espec\u00edficas (TIES o NAL).</li> <li>Personalizar tiempos de espera entre intentos.</li> <li>Cambiar fuente y tama\u00f1o de los logs.</li> </ul> </li> <li>Controles de Ejecuci\u00f3n:<ul> <li>Bot\u00f3n de inicio y detenci\u00f3n del proceso.</li> <li>Visualizaci\u00f3n del estado actual del sistema.</li> </ul> </li> </ul> <p>Fragmento Relevante: <pre><code>self.start_button = ttk.Button(self.button_frame, text=\"Iniciar\", command=self.run_process, state=tk.DISABLED)\nself.stop_button = ttk.Button(self.button_frame, text=\"Detener\", command=self.stop_process, state=tk.DISABLED)\nself.log_message(\"Esperando 2 segundos para iniciar...\", \"blue\")\n</code></pre></p>"},{"location":"despachp_nal/#42-automatizacion-con-selenium","title":"4.2 Automatizaci\u00f3n con Selenium","text":"<p>El sistema utiliza Selenium para navegar en el portal de XM, buscar archivos relevantes y descargarlos.</p> <p>Caracter\u00edsticas Clave:</p> <ul> <li>Navegaci\u00f3n Automatizada: Accede al portal y realiza clics en los elementos requeridos.</li> <li>Identificaci\u00f3n de Archivos: Extrae din\u00e1micamente el nombre del archivo para asegurar la descarga correcta.</li> <li>Manejo de Errores y Reintentos: Implementa reintentos autom\u00e1ticos en caso de fallos durante el proceso.</li> </ul> <p>Fragmento Relevante: <pre><code>driver.get(\"https://www.xm.com.co/generaci%C3%B3n/informes-despacho/despacho-nacional\")\nelement_clicked = driver.execute_script('''let shadowRoot = document.querySelector(\"#block-xm-content\")...''')\n</code></pre></p>"},{"location":"despachp_nal/#5-flujo-de-operacion","title":"5. Flujo de Operaci\u00f3n","text":"<ol> <li> <p>Iniciar el Proceso:</p> <ul> <li>Ejecuta el sistema con o sin argumentos:     <pre><code>python despacho_nacional.py\n</code></pre></li> <li>La interfaz gr\u00e1fica se inicializa autom\u00e1ticamente.</li> </ul> </li> <li> <p>Monitoreo Autom\u00e1tico:</p> <ul> <li>El sistema navega al portal de XM, identifica el archivo correspondiente al d\u00eda y lo descarga.</li> </ul> </li> <li> <p>Procesamiento de Datos:</p> <ul> <li>Los datos descargados son procesados y convertidos en un archivo <code>.txt</code> legible.</li> </ul> </li> <li> <p>Visualizaci\u00f3n de Resultados:</p> <ul> <li>Los archivos procesados se almacenan en:     <pre><code>C:\\Users\\&lt;usuario&gt;\\OneDrive - GEAM\\Operaciones GEAM\\Gestion\\despacho\\\n</code></pre></li> <li>Los logs detallados del proceso se muestran en la interfaz gr\u00e1fica.</li> </ul> </li> </ol>"},{"location":"despachp_nal/#diagrama-de-flujo-de-procesos","title":"Diagrama de flujo de procesos","text":"<pre><code>graph TD\n    A[Inicia Ejecuci\u00f3n del Script] --&gt; B[Inicializa Interfaz Gr\u00e1fica]\n    B --&gt; C[Verifica Configuraci\u00f3n y Par\u00e1metros]\n    C --&gt;|Par\u00e1metros Correctos| D[Inicia Monitoreo Autom\u00e1tico]\n    C --&gt;|Par\u00e1metros Incorrectos| E[Muestra Error en Logs]\n    D --&gt; F[Navega al Portal de XM]\n    F --&gt; G[Identifica Archivos Disponibles]\n    G --&gt;|Archivo Encontrado| H[Descarga Archivo de Despacho Nacional]\n    G --&gt;|Archivo No Encontrado| I[Reintenta Monitoreo]\n    H --&gt; J[Procesa Archivo Descargado]\n    J --&gt; K[Guarda Resultados en Carpeta de Destino]\n    K --&gt; M[Actualiza Estado en Interfaz]\n    M --&gt; N[Finaliza Proceso o Reinicia Monitoreo]\n    I --&gt; D</code></pre> <p>Este diagrama ilustra el flujo de operaci\u00f3n del sistema de monitoreo y procesamiento del Despacho Nacional, desde la ejecuci\u00f3n inicial hasta la descarga, procesamiento y almacenamiento de datos. Cada paso considera validaciones, manejo de errores y reintentos para garantizar la resiliencia del proceso.</p>"},{"location":"despachp_nal/#6-resultados-generados","title":"6. Resultados Generados","text":"<ul> <li>Archivos Descargados:   Los datos del despacho nacional se guardan como:   <pre><code>public_ddec_nalYYYYMMDD.txt\n</code></pre></li> <li>Archivos Procesados:   Se crea una copia del archivo procesado en la carpeta de descargas del sistema.</li> </ul>"},{"location":"despachp_nal/#7-solucion-de-problemas","title":"7. Soluci\u00f3n de Problemas","text":"<ul> <li> <p>No se descargan archivos:</p> <ul> <li>Verifica que el sitio web de XM est\u00e9 accesible.</li> <li>Aseg\u00farate de que los permisos de la carpeta de destino sean correctos.</li> </ul> </li> <li> <p>Errores con Selenium:</p> <ul> <li>Aseg\u00farate de que el WebDriver est\u00e9 actualizado:   <pre><code>pip install webdriver-manager\n</code></pre></li> </ul> </li> <li> <p>El sistema se detiene inesperadamente:</p> <ul> <li>Revisa los logs en la interfaz gr\u00e1fica para identificar el problema.</li> </ul> </li> </ul>"},{"location":"despachp_nal/#8-futuras-mejoras","title":"8. Futuras Mejoras","text":"<p>Alertas Automatizadas:: Enviar notificaciones al detectar actualizaciones cr\u00edticas.</p>"},{"location":"despachp_nal/#9-conclusion","title":"9. Conclusi\u00f3n","text":"<p>El sistema de monitoreo y procesamiento del Despacho Nacional es una herramienta eficiente para garantizar la disponibilidad de informaci\u00f3n cr\u00edtica para la gesti\u00f3n operativa. Gracias a su dise\u00f1o modular y enfoque en la automatizaci\u00f3n, el sistema no solo cumple con los est\u00e1ndares regulatorios, sino que tambi\u00e9n proporciona flexibilidad y personalizaci\u00f3n a los usuarios.</p>"},{"location":"index%20copy/","title":"Index copy","text":""},{"location":"index%20copy/#proyecto-scraping-despacho-nacional-y-predespacho-ideal","title":"Proyecto: Scraping Despacho Nacional y Predespacho Ideal","text":""},{"location":"index%20copy/#proposito-del-proyecto","title":"Prop\u00f3sito del Proyecto","text":"<p>Este proyecto aborda la automatizaci\u00f3n y procesamiento de datos esenciales para la gesti\u00f3n del mercado el\u00e9ctrico colombiano, enfocado en dos \u00e1reas cr\u00edticas:</p> <ol> <li> <p>Despacho Nacional:    Automatizaci\u00f3n del monitoreo, descarga y an\u00e1lisis de datos relacionados con el programa de generaci\u00f3n y los recursos asociados al Despacho Nacional. Este proceso garantiza la eficiencia operativa y el cumplimiento con normativas regulatorias clave como las Resoluciones CREG 004 de 2003, CREG 014 de 2004, CREG 096 de 2008, CREG 051 de 2009, y CREG 076 de 2009.</p> </li> <li> <p>Predespacho Ideal:    Gesti\u00f3n automatizada para obtener y analizar informaci\u00f3n relacionada con los costos marginales y los precios de oferta en el mercado el\u00e9ctrico. Este sistema se encuentra alineado con las Resoluciones CREG 051 de 2009 y CREG 076 de 2009, asegurando un an\u00e1lisis detallado para la toma de decisiones informadas.</p> </li> </ol>"},{"location":"index%20copy/#caracteristicas-clave","title":"Caracter\u00edsticas Clave","text":"<ol> <li> <p>Automatizaci\u00f3n Completa:    Los sistemas automatizan la descarga de datos desde el portal oficial de XM, procesan los datos en tiempo real y generan reportes detallados. Esto elimina la necesidad de supervisi\u00f3n manual constante y mejora la precisi\u00f3n operativa.</p> </li> <li> <p>Interactividad y Configuraci\u00f3n Personalizable:    Ambos sistemas cuentan con interfaces gr\u00e1ficas intuitivas desarrolladas en Tkinter, que permiten:</p> <ul> <li>Monitorear en tiempo real.</li> <li>Configurar par\u00e1metros como tiempos de espera y alertas espec\u00edficas.</li> <li>Cambiar entre modos de operaci\u00f3n seg\u00fan las necesidades operativas.</li> </ul> </li> <li> <p>Cumplimiento Normativo:    Los datos descargados y procesados cumplen con las regulaciones establecidas, proporcionando confianza en la calidad y exactitud de los resultados generados.</p> </li> <li> <p>Resiliencia Operativa:    Los mecanismos de reintento y manejo de errores aseguran que los sistemas contin\u00faen funcionando incluso en situaciones de falla temporal, como la indisponibilidad de archivos en el portal de XM.</p> </li> <li> <p>Ejecuci\u00f3n Autom\u00e1tica:     Por medio del gestor de tareas de Windows, se programa que los scripts se ejecuten autom\u00e1ticamente e inicien el monitoreo en el horario establecido.</p> </li> </ol> <p> </p>"},{"location":"index%20copy/#impacto-operativo","title":"Impacto Operativo","text":"<ul> <li> <p>Despacho Nacional:   Asegura la disponibilidad de informaci\u00f3n del programa de generaci\u00f3n diaria, optimizando la asignaci\u00f3n de recursos energ\u00e9ticos.   Facilita el an\u00e1lisis hist\u00f3rico y la planificaci\u00f3n estrat\u00e9gica mediante el almacenamiento estructurado de datos procesados.</p> </li> <li> <p>Predespacho Ideal:   Proporciona an\u00e1lisis detallados sobre los costos marginales, identificando tendencias clave y umbrales de escasez. Este sistema permite a los operadores del mercado el\u00e9ctrico tomar decisiones informadas en tiempo real, garantizando eficiencia y transparencia.</p> </li> </ul> <p>Ambos m\u00f3dulos contribuyen a la modernizaci\u00f3n y digitalizaci\u00f3n de la gesti\u00f3n energ\u00e9tica en Colombia, destacando la importancia de herramientas automatizadas en sectores regulados como el el\u00e9ctrico.</p>"},{"location":"instalacion/","title":"Instalacion","text":""},{"location":"instalacion/#instalacion-y-configuracion-del-entorno-para-el-proyecto-geam","title":"Instalaci\u00f3n y Configuraci\u00f3n del Entorno para el Proyecto GEAM","text":"<p>Este apartado detalla los pasos necesarios para configurar un entorno funcional que permita la implementaci\u00f3n y ejecuci\u00f3n de los procesos de carga, transformaci\u00f3n y an\u00e1lisis de datos utilizados en el proyecto de GEAM. El objetivo principal es garantizar una instalaci\u00f3n uniforme de herramientas y dependencias, configurar correctamente las conexiones a las bases de datos y estructurar el entorno para el \u00f3ptimo funcionamiento del Data Warehouse (DWH).</p>"},{"location":"instalacion/#pasos-para-la-configuracion-del-entorno","title":"Pasos para la Configuraci\u00f3n del Entorno","text":""},{"location":"instalacion/#1-instalacion-de-herramientas-necesarias","title":"1. Instalaci\u00f3n de Herramientas Necesarias","text":""},{"location":"instalacion/#versionamiento-de-herramientas","title":"Versionamiento de Herramientas","text":"<p>Los paquetes ETL del proyecto GEAM se desarrollaron originalmente utilizando Visual Studio Community 2022, seg\u00fan las definiciones establecidas en la fase 1 del proyecto. Posteriormente, en la entrega del proyecto, GEAM degrada a la versi\u00f3n Visual Studio Professional 2019 para garantizar compatibilidad con los est\u00e1ndares de la organizaci\u00f3n.</p> <p>Entre el 14 y el 17 de enero de 2025, se llevaron a cabo mesas de trabajo conjuntas con el equipo de GEAM. Durante estas sesiones, se validaron los paquetes y se realiz\u00f3 la migraci\u00f3n al servidor de pruebas, asegurando el correcto funcionamiento en el entorno de la organizaci\u00f3n. </p>"},{"location":"instalacion/#11-sql-server-management-studio-ssms","title":"1.1 SQL Server Management Studio (SSMS)","text":"<p>Requisitos:</p> <ul> <li>Versi\u00f3n 20.1.10.0 o posterior.</li> <li>Disponible en el siguiente enlace: Descargar SSMS.</li> </ul>"},{"location":"instalacion/#12-visual-studio","title":"1.2 Visual Studio","text":"<p>Versi\u00f3n:</p> <ul> <li>GEAM utiliza Visual Studio Profesional 2019 (paga).</li> <li>Para desarrollo, se utiliza Visual Studio Community 2022 (gratuita), versi\u00f3n 17.11.5.</li> <li>Disponible en el siguiente enlace: Descargar Visual Studio Community.</li> </ul>"},{"location":"instalacion/#13-integration-services-ssis","title":"1.3 Integration Services (SSIS)","text":"<p>Pasos de Instalaci\u00f3n:</p> <ol> <li>Crear un proyecto en blanco en Visual Studio.</li> <li>Ir a la pesta\u00f1a Extensiones \u2192 Administrar Extensiones.</li> <li>Buscar Integration Services e instalar la versi\u00f3n 1.3.2 (compatibilidad con Visual Studio 17.11.5).</li> </ol>"},{"location":"instalacion/#14-analysis-services-ssas","title":"1.4 Analysis Services (SSAS)","text":"<p>Pasos de Instalaci\u00f3n:</p> <ol> <li>Crear un proyecto en blanco en Visual Studio.</li> <li>Ir a la pesta\u00f1a Extensiones \u2192 Administrar Extensiones.</li> <li>Buscar Analysis Services e instalar la versi\u00f3n m\u00e1s reciente.</li> <li>Validar que no presente problemas de compatibilidad.</li> </ol>"},{"location":"instalacion/#recomendaciones","title":"Recomendaciones:","text":"<p>Se recomienda dejar las mismas estructuras. La actualizaci\u00f3n de datos de consultas y web scraping es autom\u00e1tica. Y la de archivos corresponde a los propietarios de la informaci\u00f3n.</p>"},{"location":"instalacion/#2-creacion-del-entorno-virtual","title":"2. Creaci\u00f3n del Entorno Virtual","text":"<p>Un entorno virtual permite organizar y aislar las dependencias necesarias para este proyecto. Siga estos pasos:</p> <p>1. Cree un entorno virtual ejecutando el siguiente comando:</p> <pre><code>python -m venv GEAM_env\n</code></pre> <p>2. Active el entorno virtual:</p> <p>En Windows:</p> <pre><code>GEAM_env\\Scripts\\activate\n</code></pre> <p>En Linux/macOS:</p> <pre><code>source GEAM_env/bin/activate\n</code></pre>"},{"location":"instalacion/#3-instalacion-de-dependencias","title":"3. Instalaci\u00f3n de Dependencias","text":"<p>Una vez activado el entorno virtual, instale las librer\u00edas necesarias:</p> <pre><code>pip install sqlalchemy pandas beautifulsoup4 numpy logging python-dateutil concurrent.futures\n</code></pre>"},{"location":"instalacion/#configuracion-inicial-del-proyecto","title":"Configuraci\u00f3n Inicial del Proyecto","text":""},{"location":"instalacion/#1-creacion-de-conexiones","title":"1. Creaci\u00f3n de Conexiones","text":"<p>1. Configuraci\u00f3n en SSIS:</p> <ul> <li>Use el administrador de conexiones ADO.NET.</li> <li>Cree las siguientes conexiones:<ul> <li><code>DWH_GEAM</code></li> <li><code>STAGE_AREA</code></li> <li><code>SAP_ERP</code></li> </ul> </li> <li>Es importante tener activa la VPN al configurar las conexiones.</li> </ul> <p>2. Configuraci\u00f3n Local:</p> <ul> <li>Cree una base de datos local en SQL Server Management Studio llamada <code>DWH_GEAM_local</code> para realizar pruebas.</li> <li>Cree una conexi\u00f3n a esta base local.</li> </ul> <p>3. Parametrizaci\u00f3n de Conexiones:</p> <ul> <li>Configure las variables <code>ConnectionString</code> y <code>Password</code> en el proyecto de SSIS para cada conexi\u00f3n.</li> <li>Consulte el siguiente video (minuto 11 en adelante).</li> </ul> <p>4. Referencia de Proyecto:</p> <ul> <li>Abra el proyecto de referencia disponible en: Proyecto SSIS.</li> </ul>"},{"location":"instalacion/#funciones-principales-del-proyecto","title":"Funciones Principales del Proyecto","text":""},{"location":"instalacion/#1-configuracion-del-logger","title":"1. Configuraci\u00f3n del Logger","text":"<p>Para garantizar un registro de eventos y errores, utilice la funci\u00f3n <code>setup_logger</code>:</p> <pre><code>from Funciones import setup_logger\nimport logging\n\nlogger = setup_logger(log_filename='etl.log', log_level=logging.INFO)\nlogger.info(\"Proceso de configuraci\u00f3n iniciado.\")\n</code></pre>"},{"location":"instalacion/#2-conexion-a-la-base-de-datos","title":"2. Conexi\u00f3n a la Base de Datos","text":"<p>Configure la conexi\u00f3n a las bases de datos con la funci\u00f3n <code>obtener_conexion</code> y el uso de SQLAlchemy:</p> <pre><code>from Funciones import obtener_conexion\nfrom sqlalchemy import create_engine\n\ncadena_conexion = obtener_conexion('nombre_base_datos')\nmotor = create_engine(cadena_conexion)\n</code></pre>"},{"location":"instalacion/#3-funciones-de-procesamiento","title":"3. Funciones de Procesamiento","text":""},{"location":"instalacion/#31-guardar_en_dwh","title":"3.1 <code>guardar_en_dwh</code>","text":"<ul> <li>Prop\u00f3sito: Guarda un <code>DataFrame</code> en una tabla espec\u00edfica del DWH.</li> <li>Uso:</li> </ul> <pre><code>from Funciones import guardar_en_dwh\n\nguardar_en_dwh(df, 'nombre_tabla', logger, multiple=False, if_exists='replace')\n</code></pre>"},{"location":"instalacion/#32-limpiar_html","title":"3.2 <code>limpiar_html</code>","text":"<ul> <li>Prop\u00f3sito: Limpia el contenido de texto con etiquetas HTML.</li> <li>Uso:</li> </ul> <pre><code>from Funciones import limpiar_html\n\ntexto_limpio = limpiar_html(\"&lt;p&gt;Ejemplo&lt;/p&gt;\")\nprint(texto_limpio)  # Salida: Ejemplo\n</code></pre>"},{"location":"instalacion/#33-storeduplicated","title":"3.3 <code>StoreDuplicated</code>","text":"<ul> <li>Prop\u00f3sito: Guarda registros duplicados para an\u00e1lisis posterior.</li> <li>Uso:</li> </ul> <pre><code>from Funciones import StoreDuplicated\n\nStoreDuplicated(\"duplicados.xlsx\", ['columna1', 'columna2'], df, './output')\n</code></pre>"},{"location":"instalacion/#creacion-del-cubo","title":"Creaci\u00f3n del Cubo","text":"<p>1. Configuraci\u00f3n del Cubo:</p> <ul> <li>Use Analysis Services para crear un cubo que contenga las medidas y KPIs necesarios.</li> <li>Incluya esquemas de datos de <code>Transversal</code>, <code>Colegio</code>, <code>Cedesarrollo</code> y <code>Protecci\u00f3n</code>.</li> </ul> <p>2. Poblaci\u00f3n de Tablas:</p> <ul> <li>Llene primero las tablas Dim y posteriormente las tablas Fact.</li> <li>Aseg\u00farese de que las tablas de DWH est\u00e9n vac\u00edas antes de iniciar el proceso de carga.</li> </ul> <p>3. Consumo en Power BI:</p> <ul> <li>Todas las medidas deben estar definidas en el cubo, ya que Power BI no permite la creaci\u00f3n de medidas en tiempo de consulta.</li> </ul> <p>4. Referencias:</p> <ul> <li>Creaci\u00f3n del Cubo 1.</li> <li>Creaci\u00f3n del Cubo 2.</li> </ul>"},{"location":"instalacion/#ejemplo-de-flujo-etl","title":"Ejemplo de Flujo ETL","text":"<pre><code>from Funciones import obtener_conexion, guardar_en_dwh, setup_logger\nimport pandas as pd\nfrom sqlalchemy import create_engine\n\n# Configurar logger\nlogger = setup_logger(log_filename='etl_proceso.log', log_level=logging.INFO)\n\n# Conectar a la base de datos\ncadena_conexion = obtener_conexion('dwh_GEAM')\nmotor = create_engine(cadena_conexion)\n\n# Leer datos de origen\ndf_origen = pd.read_sql_query(\"SELECT * FROM tabla_origen\", motor)\n\n# Transformaciones necesarias\ndf_origen['nueva_columna'] = df_origen['columna_existente'] * 2\n\n# Cargar datos transformados al DWH\nguardar_en_dwh(df_origen, 'tabla_destino', logger, multiple=False, if_exists='append')\n</code></pre>"},{"location":"instalacion/#conclusion","title":"Conclusi\u00f3n","text":"<p>Con estos pasos, el entorno estar\u00e1 listo para manejar los procesos ETL del proyecto GEAM. Al seguir este flujo, se asegura una configuraci\u00f3n consistente, se minimizan errores y se facilita la integraci\u00f3n de nuevos m\u00f3dulos o expansiones del DWH.</p>"},{"location":"precio_bolsa/","title":"PRECIO BOLSA HORARIO","text":""},{"location":"precio_bolsa/#automatizacion-del-predespacho-ideal-con-analisis-del-costo-marginal","title":"Automatizaci\u00f3n del Predespacho Ideal con An\u00e1lisis del Costo Marginal","text":""},{"location":"precio_bolsa/#1-introduccion","title":"1. Introducci\u00f3n","text":"<p>El sistema desarrollado tiene como objetivo automatizar la descarga, procesamiento y an\u00e1lisis de los datos del Predespacho Ideal proporcionados por XM. Este proceso es clave para evaluar el comportamiento del mercado el\u00e9ctrico, particularmente en lo referente a los costos marginales y precios de oferta. La implementaci\u00f3n est\u00e1 dise\u00f1ada para cumplir con las regulaciones establecidas por las Resoluciones CREG 051 de 2009 y CREG 076 de 2009.</p>"},{"location":"precio_bolsa/#que-es-el-predespacho-ideal","title":"\u00bfQu\u00e9 es el Predespacho Ideal?","text":"<p>El Predespacho Ideal contiene informaci\u00f3n sobre:</p> <ul> <li>El programa de generaci\u00f3n para cada recurso disponible durante el d\u00eda especificado (dd).</li> <li>Los precios de oferta del recurso denominado MPO en cada periodo del d\u00eda.</li> </ul> <p>Esta informaci\u00f3n es cr\u00edtica para garantizar la eficiencia operativa del mercado y la transparencia en la asignaci\u00f3n de recursos. Los usuarios que no encuentren los archivos requeridos en el sistema pueden consultar el servicio FTPS en la ruta: <code>/INFORMACION_XM/Publico/PredespachoIdeal/</code>.</p>"},{"location":"precio_bolsa/#objetivo-principal","title":"Objetivo Principal","text":"<p>La finalidad de este script es obtener informaci\u00f3n esencial sobre el programa de generaci\u00f3n y los precios de oferta de recursos del Predespacho Ideal. Adem\u00e1s, se realiza un an\u00e1lisis detallado de los datos del costo marginal para identificar tendencias, valores clave y umbrales de escasez. Este an\u00e1lisis ayuda a tomar decisiones informadas en tiempo real dentro del contexto de la operaci\u00f3n del sistema el\u00e9ctrico.</p>"},{"location":"precio_bolsa/#funcionalidades-principales","title":"Funcionalidades Principales","text":"<ol> <li> <p>Descarga y Validaci\u00f3n de Archivos:</p> <ul> <li>El script busca autom\u00e1ticamente los archivos esperados, nombrados seg\u00fan el formato de fecha del d\u00eda siguiente (<code>public_imar_nalMMDD.txt</code> y <code>iMARMMDD_NAL.txt</code>).</li> <li>En caso de no encontrar los archivos en el sistema local, el script intenta obtenerlos mediante su descarga desde el servicio FTP p\u00fablico proporcionado por XM.</li> </ul> </li> <li> <p>Procesamiento de Datos:</p> <ul> <li>Los archivos descargados son le\u00eddos para extraer los datos correspondientes al costo marginal, que se presentan en un formato delimitado por comas.</li> <li>Los datos extra\u00eddos son convertidos a una lista de valores num\u00e9ricos para su an\u00e1lisis y visualizaci\u00f3n.</li> </ul> </li> <li> <p>An\u00e1lisis del Costo Marginal:</p> <ul> <li>Se realizan c\u00e1lculos de m\u00e1ximos, m\u00ednimos y promedios del costo marginal.</li> <li>Se define un umbral de escasez, equivalente al 95% de un valor de referencia fijo (951.76), para identificar periodos cr\u00edticos.</li> <li>Los valores que superan este umbral son clasificados y sus rangos son identificados.</li> </ul> </li> <li> <p>Visualizaci\u00f3n Gr\u00e1fica:</p> <ul> <li>El costo marginal es graficado con indicadores claros de los valores m\u00e1ximos, m\u00ednimos y aquellos cercanos al umbral de escasez.</li> <li>Cambios significativos en la serie son resaltados visualmente.</li> <li>La gr\u00e1fica se guarda como un archivo de imagen para documentaci\u00f3n y referencia.</li> </ul> </li> <li> <p>Narrativa y Documentaci\u00f3n:</p> <ul> <li>Se genera un archivo de texto que incluye una narrativa descriptiva del an\u00e1lisis realizado, destacando los valores m\u00e1s relevantes y los periodos cr\u00edticos.</li> <li>Este archivo facilita la comunicaci\u00f3n de los resultados a las partes interesadas.</li> </ul> </li> <li> <p>Gesti\u00f3n de Errores y Reintentos:</p> <ul> <li>El sistema implementa un mecanismo de espera y reintento autom\u00e1tico en caso de que los archivos no est\u00e9n disponibles inicialmente.</li> <li>Este enfoque asegura la resiliencia y fiabilidad del proceso.</li> </ul> </li> <li> <p>Notificaci\u00f3n por Correo Electr\u00f3nico:</p> <ul> <li>El sistema env\u00eda un correo electr\u00f3nico al equipo de operaciones con los resultados del an\u00e1lisis en tiempo real.</li> <li>El correo incluye la gr\u00e1fica del costo marginal y el reporte narrativo generado.</li> <li> <p>Configuraci\u00f3n del correo:   <pre><code>import smtplib\nfrom email.mime.multipart import MIMEMultipart\nfrom email.mime.text import MIMEText\nfrom email.mime.base import MIMEBase\nfrom email import encoders\n\ndef enviar_correo(destinatario, asunto, cuerpo, archivo_adjunto):\n          remitente = \"tu_correo@example.com\"\n          password = \"tu_contrase\u00f1a\"\n</code></pre></p> </li> <li> <p>Ejemplo:</p> </li> </ul> </li> </ol> <p></p>"},{"location":"precio_bolsa/#importancia-operativa","title":"Importancia Operativa","text":"<p>Este sistema es esencial para la operaci\u00f3n eficiente y confiable del mercado el\u00e9ctrico, ya que proporciona:</p> <ul> <li>Informaci\u00f3n en Tiempo Real: Los datos procesados permiten ajustar decisiones operativas seg\u00fan las condiciones del mercado.</li> <li>Cumplimiento Normativo: El an\u00e1lisis sigue los lineamientos regulatorios establecidos por la CREG, garantizando que la informaci\u00f3n generada es v\u00e1lida para la toma de decisiones oficiales.</li> </ul>"},{"location":"precio_bolsa/#2-descripcion-general-del-sistema","title":"2. Descripci\u00f3n General del Sistema","text":"<p>El sistema est\u00e1 compuesto por dos m\u00f3dulos principales:</p> <ol> <li><code>marginal.py</code> (Principal): Responsable de procesar los datos descargados, analizar los costos marginales y generar gr\u00e1ficos y reportes detallados.</li> <li><code>predespacho_ideal.py</code>: M\u00f3dulo auxiliar encargado de realizar la descarga autom\u00e1tica de los datos desde el portal de XM mediante Selenium.</li> </ol>"},{"location":"precio_bolsa/#3-configuracion-inicial","title":"3. Configuraci\u00f3n Inicial","text":""},{"location":"precio_bolsa/#31-requisitos-del-sistema","title":"3.1 Requisitos del Sistema","text":"<p>Para utilizar este sistema, es necesario contar con:</p> <ul> <li>Python 3.8 o superior.</li> <li>Librer\u00edas requeridas:      <pre><code>pip install selenium matplotlib pandas webdriver-manager\n</code></pre></li> <li>Google Chrome instalado y actualizado.</li> </ul>"},{"location":"precio_bolsa/#32-configuracion-de-selenium","title":"3.2 Configuraci\u00f3n de Selenium","text":"<p>El sistema utiliza Selenium en modo headless para realizar las descargas:</p> <ul> <li>Carpeta de destino: <pre><code>C:\\Users\\&lt;usuario&gt;\\OneDrive - GEAM\\Operaciones GEAM\\Operaciones\\Despacho\\\n</code></pre></li> <li>Configuraci\u00f3n adicional del navegador:      El navegador est\u00e1 configurado para descargar autom\u00e1ticamente los archivos sin intervenci\u00f3n del usuario.</li> </ul>"},{"location":"precio_bolsa/#33-estructura-del-proyecto","title":"3.3 Estructura del Proyecto","text":"<p>El sistema debe organizarse como sigue:     <pre><code>/marginal.py\n/predespacho_ideal.py\n</code></pre>     Archivos generados:</p> <ul> <li>Gr\u00e1ficos y reportes: Se almacenan en la carpeta designada.</li> </ul>"},{"location":"precio_bolsa/#4-descripcion-detallada-de-los-modulos","title":"4. Descripci\u00f3n Detallada de los M\u00f3dulos","text":""},{"location":"precio_bolsa/#41-marginalpy","title":"4.1 <code>marginal.py</code>","text":"<p>Este es el m\u00f3dulo principal que ejecuta el flujo completo del sistema. Sus principales tareas incluyen:</p> <ol> <li>Llamar a <code>predespacho_ideal.py</code> para descargar los datos.</li> <li>Analizar la informaci\u00f3n del costo marginal.</li> <li>Generar gr\u00e1ficos y reportes narrativos.</li> </ol> <p>Funciones Clave:</p>"},{"location":"precio_bolsa/#funcion-graficar_costo_marginalcosto_marginal_nuevo","title":"Funci\u00f3n <code>graficar_costo_marginal(costo_marginal_nuevo)</code>","text":"<p>Analiza y visualiza los costos marginales.  </p> <ul> <li>C\u00e1lculos realizados:<ul> <li>M\u00e1ximos, m\u00ednimos y promedios del costo marginal.</li> <li>Identificaci\u00f3n de valores que exceden el umbral de escasez (95% de 951.76).</li> </ul> </li> <li>Salida:<ul> <li>Una gr\u00e1fica que resalta valores significativos.</li> <li>Una narrativa descriptiva con resultados clave.</li> </ul> </li> </ul> <p>Fragmento Relevante: <pre><code>umbral_escasez = escasez * 0.95\nvalores_sobre_umbral = [i for i, valor in enumerate(costo_marginal_dividido) if valor &gt; umbral_escasez]\nplt.axhline(y=umbral_escasez, color='blue', linestyle='--', label=f'Umbral de Escasez: ${umbral_escasez:,.2f}')\n</code></pre></p>"},{"location":"precio_bolsa/#funcion-esperartiempo-intento","title":"Funci\u00f3n <code>esperar(tiempo, intento)</code>","text":"<p>Gestiona los temporizadores en caso de que los archivos no est\u00e9n disponibles.  </p> <p>Fragmento Relevante: <pre><code>for i in range(tiempo, 0, -1):        \n    print(f\"Esperando {i}s... Intento {intento}\", end='\\r')\n    time.sleep(1)\n</code></pre></p>"},{"location":"precio_bolsa/#interaccion-con-predespacho_idealpy","title":"Interacci\u00f3n con <code>predespacho_ideal.py</code>","text":"<p>El m\u00f3dulo llama a la funci\u00f3n <code>ejecutar()</code> para descargar los archivos necesarios.</p>"},{"location":"precio_bolsa/#42-predespacho_idealpy","title":"4.2 <code>predespacho_ideal.py</code>","text":"<p>Este m\u00f3dulo utiliza Selenium para interactuar con el portal de XM y descargar los datos del Predespacho Ideal.</p> <p>Funciones Clave:</p>"},{"location":"precio_bolsa/#funcion-ejecutar","title":"Funci\u00f3n <code>ejecutar()</code>","text":"<p>Descarga los archivos requeridos desde el portal de XM:</p> <ul> <li>Navega al sitio correspondiente.</li> <li>Identifica din\u00e1micamente el archivo deseado.</li> <li>Realiza la descarga y lo guarda en la carpeta designada.</li> </ul> <p>Fragmento Relevante: <pre><code>driver.get(\"https://www.xm.com.co/corto-plazo/despacho-energia/predespacho-ideal\")\nbutton_element.click()\n</code></pre></p>"},{"location":"precio_bolsa/#funcion-continuar_procesodriver","title":"Funci\u00f3n <code>continuar_proceso(driver)</code>","text":"<p>Procesa el contenido de la p\u00e1gina web y convierte el texto CSV en datos tabulares utilizables.</p>"},{"location":"precio_bolsa/#5-flujo-de-operacion","title":"5. Flujo de Operaci\u00f3n","text":"<ol> <li> <p>Ejecutar <code>marginal.py</code>: <pre><code>python marginal.py\n</code></pre></p> </li> <li> <p>Descarga de Archivos:</p> <ul> <li>El sistema navega autom\u00e1ticamente al portal de XM.</li> <li>Identifica y descarga los archivos relacionados con el d\u00eda siguiente.</li> </ul> </li> <li> <p>An\u00e1lisis de los Datos:</p> <ul> <li>Se procesan los costos marginales.</li> <li>Se genera una gr\u00e1fica y un reporte narrativo.</li> </ul> </li> <li> <p>Resultados Generados:</p> <ul> <li>Gr\u00e1fica del Costo Marginal: <pre><code>C:\\Users\\&lt;usuario&gt;\\OneDrive - GEAM\\Operaciones GEAM\\Operaciones\\Despacho\\pbolsahorario_image.png\n</code></pre></li> <li>Reporte Narrativo: <pre><code>C:\\Users\\&lt;usuario&gt;\\OneDrive - GEAM\\Operaciones GEAM\\Operaciones\\Despacho\\pbolsahorario_texto.txt\n</code></pre></li> </ul> </li> </ol>"},{"location":"precio_bolsa/#diagrama-de-flujo-de-procesos","title":"Diagrama de flujo de procesos","text":"<pre><code>graph TD\n    A[Inicia Ejecuci\u00f3n del Script] --&gt; B[Verifica Archivos Locales]\n    B --&gt;|Archivos Disponibles| C[Procesa Datos]\n    B --&gt;|Archivos No Disponibles| D[Descarga Archivos del Portal XM]\n    D --&gt; E[Valida Archivos Descargados]\n    E --&gt;|Validaci\u00f3n Exitosa| C\n    E --&gt;|Error en la Validaci\u00f3n| F[Reintenta Descarga]\n    F --&gt; D\n    C --&gt; G[Realiza C\u00e1lculos del Costo Marginal]\n    G --&gt; J[Genera Gr\u00e1fica de Resultados]\n    G --&gt; K[Genera Narrativa de Resultados]\n    J --&gt; L[Finaliza Proceso]\n    K --&gt; L</code></pre> <p>Este diagrama representa el flujo del sistema para la automatizaci\u00f3n del Predespacho Ideal, desde la ejecuci\u00f3n del script hasta la generaci\u00f3n de gr\u00e1ficos y reportes narrativos. Cada paso incluye validaciones y reintentos autom\u00e1ticos en caso de errores.</p>"},{"location":"precio_bolsa/#6-solucion-de-problemas","title":"6. Soluci\u00f3n de Problemas","text":"<ul> <li> <p>El sistema no descarga los archivos:</p> <ul> <li>Verifica que el sitio web de XM est\u00e9 accesible.</li> <li>Revisa los permisos de la carpeta de destino.</li> </ul> </li> <li> <p>Errores con Selenium:</p> <ul> <li>Aseg\u00farate de tener instalada la \u00faltima versi\u00f3n de ChromeDriver:   <pre><code>pip install webdriver-manager\n</code></pre></li> </ul> </li> <li> <p>Los datos est\u00e1n incompletos o no se procesan correctamente:</p> <ul> <li>Confirma que los archivos descargados contengan la informaci\u00f3n esperada.</li> </ul> </li> </ul>"},{"location":"precio_bolsa/#7-futuras-mejoras","title":"7. Futuras Mejoras","text":"<ol> <li> <p>Integraci\u00f3n con FTPS:    Agregar soporte directo para la ruta <code>/INFORMACION_XM/Publico/PredespachoIdeal/</code>.</p> </li> <li> <p>Alertas Automatizadas:    Notificaciones en tiempo real sobre valores cr\u00edticos.</p> </li> <li> <p>Paralelismo:    Ejecutar la descarga y el an\u00e1lisis de forma simult\u00e1nea para mejorar la eficiencia.</p> </li> </ol>"},{"location":"precio_bolsa/#conclusion","title":"Conclusi\u00f3n","text":"<p>Este sistema de scraping y an\u00e1lisis del Predespacho Ideal es una herramienta poderosa para los operadores del mercado el\u00e9ctrico. No solo automatiza procesos cr\u00edticos, sino que tambi\u00e9n ofrece un an\u00e1lisis profundo y visual de los datos m\u00e1s relevantes, asegurando decisiones informadas en un entorno altamente regulado. Este enfoque resalta la importancia de la digitalizaci\u00f3n y automatizaci\u00f3n en la gesti\u00f3n moderna de sistemas el\u00e9ctricos.</p>"},{"location":"scraping_prom_tgi/","title":"PROMIGAS TGI","text":""},{"location":"scraping_prom_tgi/#manual-del-usuario-gestion-de-volumenes-tgi-y-promigas","title":"Manual del Usuario: Gesti\u00f3n de Vol\u00famenes TGI y Promigas","text":""},{"location":"scraping_prom_tgi/#1-introduccion","title":"1. Introducci\u00f3n","text":"<p>Este sistema automatiza la descarga y procesamiento de datos de vol\u00famenes de gas de TGI y Promigas, actores clave en la distribuci\u00f3n de gas natural en Colombia. Proporciona informaci\u00f3n cr\u00edtica para la gesti\u00f3n operativa diaria, incluyendo:</p> <ul> <li>TGI: Consolidado de recibos diarios con detalles de entregas por productor.</li> <li>Promigas: Vol\u00famenes entregados por productor en KPCD (Miles de Pies C\u00fabicos por D\u00eda).</li> </ul>"},{"location":"scraping_prom_tgi/#objetivo-principal","title":"Objetivo Principal","text":"<p>Automatizar la recolecci\u00f3n de datos operativos desde los portales web de TGI y Promigas, garantizando: - Actualizaci\u00f3n diaria sin intervenci\u00f3n manual. - Procesamiento estandarizado en formatos Excel. - Interfaz intuitiva para monitoreo y control del proceso.</p>"},{"location":"scraping_prom_tgi/#2-configuracion-inicial","title":"2. Configuraci\u00f3n Inicial","text":""},{"location":"scraping_prom_tgi/#21-requisitos-del-sistema","title":"2.1 Requisitos del Sistema","text":"<ul> <li>Python 3.8+ y gestor de paquetes <code>pip</code>.</li> <li>Librer\u00edas requeridas:   <pre><code>pip install pandas selenium openpyxl webdriver-manager tkinter\n</code></pre></li> <li>Google Chrome actualizado.</li> </ul>"},{"location":"scraping_prom_tgi/#22-configuracion-de-rutas","title":"2.2 Configuraci\u00f3n de Rutas","text":"<p>Los archivos procesados se guardan en: <pre><code>C:\\Users\\&lt;usuario&gt;\\OneDrive - GEAM\\Operaciones GEAM\\Operaciones\\\n</code></pre> - <code>volumen_tgi.xlsx</code>: Resultados de TGI. - <code>volumen_promigas.xlsx</code>: Resultados de Promigas.</p>"},{"location":"scraping_prom_tgi/#23-credenciales-de-acceso","title":"2.3 Credenciales de Acceso","text":"<ul> <li>Asegurar acceso a los portales:</li> <li>TGI: https://cga.tgi.com.co:8081/</li> <li>Promigas: https://www.promigas.com/BEO/</li> </ul>"},{"location":"scraping_prom_tgi/#3-funcionalidades-clave","title":"3. Funcionalidades Clave","text":""},{"location":"scraping_prom_tgi/#31-interfaz-grafica-gui","title":"3.1 Interfaz Gr\u00e1fica (GUI)","text":"<ul> <li>Controles Principales:</li> <li>Checkboxes: Ocultar/mostrar navegadores durante la ejecuci\u00f3n.</li> <li>Botones: Iniciar procesos | Salir.</li> <li>\u00c1rea de Logs: Muestra eventos en tiempo real.</li> </ul>"},{"location":"scraping_prom_tgi/#32-procesos-automatizados","title":"3.2 Procesos Automatizados","text":"Funci\u00f3n Descripci\u00f3n <code>promigas()</code> Descarga datos diarios de Promigas, procesa KPCD y genera Excel estructurado. <code>tgi()</code> Extrae consolidado de TGI, limpia datos y exporta a Excel con formato."},{"location":"scraping_prom_tgi/#4-flujo-de-operacion","title":"4. Flujo de Operaci\u00f3n","text":""},{"location":"scraping_prom_tgi/#41-ejecucion-automatica-al-iniciar","title":"4.1 Ejecuci\u00f3n Autom\u00e1tica al Iniciar","text":"<p>La aplicaci\u00f3n inicia los procesos 5 segundos despu\u00e9s de abrirse, sin requerir interacci\u00f3n.</p>"},{"location":"scraping_prom_tgi/#42-pasos-detallados","title":"4.2 Pasos Detallados","text":"<ol> <li>Inicio de Procesos:</li> <li>Navegaci\u00f3n autom\u00e1tica a los portales.</li> <li>Configuraci\u00f3n de fechas (hoy - 5 d\u00edas para Promigas).</li> <li>Descarga de Datos:</li> <li>Interacci\u00f3n con calendarios y botones v\u00eda Selenium.</li> <li>Exportaci\u00f3n a Excel desde las plataformas.</li> <li>Procesamiento:</li> <li>Limpieza de datos.</li> <li>Formateo de columnas y conversi\u00f3n de tipos.</li> <li>Guardado:</li> <li>Archivos Excel generados en rutas predefinidas.</li> </ol>"},{"location":"scraping_prom_tgi/#diagrama-de-flujo","title":"Diagrama de Flujo","text":"<pre><code>sequenceDiagram\n    participant Usuario\n    participant GUI\n    participant Selenium\n    participant Procesamiento\n\n    Usuario-&gt;&gt;GUI: Abre aplicaci\u00f3n\n    GUI-&gt;&gt;GUI: Ejecuci\u00f3n autom\u00e1tica en 5s\n    GUI-&gt;&gt;Selenium: Inicia TGI (oculto)\n    Selenium-&gt;&gt;TGI Portal: Descarga consolidado\n    Selenium-&gt;&gt;Procesamiento: Env\u00eda datos\n    Procesamiento-&gt;&gt;Archivo: Guarda volumen_tgi.xlsx\n    GUI-&gt;&gt;Selenium: Inicia Promigas (visible)\n    Selenium-&gt;&gt;Promigas Portal: Descarga KPCD\n    Selenium-&gt;&gt;Procesamiento: Env\u00eda datos\n    Procesamiento-&gt;&gt;Archivo: Guarda volumen_promigas.xlsx\n    GUI-&gt;&gt;Usuario: Muestra logs de \u00e9xito/error</code></pre>"},{"location":"scraping_prom_tgi/#5-personalizacion-avanzada","title":"5. Personalizaci\u00f3n Avanzada","text":""},{"location":"scraping_prom_tgi/#51-modo-de-ejecucion-del-navegador","title":"5.1 Modo de Ejecuci\u00f3n del Navegador","text":"<ul> <li>Headless (predeterminado): <pre><code>self.tgi_ocultar = tk.BooleanVar(value=True)  # TGI oculto\nself.promigas_ocultar = tk.BooleanVar(value=False)  # Promigas visible\n</code></pre></li> <li>Modificar en la GUI desmarcando checkboxes.</li> </ul>"},{"location":"scraping_prom_tgi/#52-parametros-de-fecha","title":"5.2 Par\u00e1metros de Fecha","text":"<ul> <li>Promigas: Ajustar rango en c\u00f3digo (l\u00ednea 93):   <pre><code>start_date_field.send_keys(\"01/05/2024\")  # Cambiar fecha inicial\n</code></pre></li> </ul>"},{"location":"scraping_prom_tgi/#6-manejo-de-errores","title":"6. Manejo de Errores","text":"Error Com\u00fan Soluci\u00f3n Timeout en Selenium Verificar conexi\u00f3n a internet y actualizar WebDriver. Archivo de salida bloqueado Cerrar Excel antes de ejecutar. Login requerido Asegurar sesi\u00f3n activa en portales."},{"location":"scraping_prom_tgi/#7-estructura-del-codigo","title":"7. Estructura del C\u00f3digo","text":""},{"location":"scraping_prom_tgi/#71-componentes-principales","title":"7.1 Componentes Principales","text":"<ul> <li>Funciones de scraping:</li> <li><code>promigas()</code>: Maneja interacci\u00f3n con Promigas.</li> <li><code>tgi()</code>: Gestiona descarga desde TGI.</li> <li>Clase <code>Application</code>: Construye la GUI y gestiona hilos.</li> </ul>"},{"location":"scraping_prom_tgi/#72-flujo-de-datos","title":"7.2 Flujo de Datos","text":"<pre><code># Ejemplo simplificado\ndef tgi(ocultar_navegador):\n    driver = configurar_driver(ocultar_navegador)\n    # ... (interacciones Selenium)\n    procesar_datos(raw_data)\n    guardar_excel(df_procesado)\n\nclass Application(tk.Tk):\n    def __init__(self):\n        # ... (inicializar GUI)\n        self.after(5000, self.iniciar_procesos)  # Auto-run\n</code></pre>"}]}